<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Microphysics Scheme in CCPP: gscond.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Microphysics Scheme in CCPP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('gscond_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">gscond.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="gscond_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a02cb3895f68b86a4b7e259c8c098ecc1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gscond_8f.html#a02cb3895f68b86a4b7e259c8c098ecc1">gscond</a> (im, ix, km, dt, dtf, prsl, ps, q, cwm, t                                                           ,                                                               tp, qp, psp, tp1, qp1, psp1, u, lprnt, ipr)</td></tr>
<tr class="memdesc:a02cb3895f68b86a4b7e259c8c098ecc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is for grid-scale condensation&amp;evaporation for the mrf model at NCEP.  <a href="#a02cb3895f68b86a4b7e259c8c098ecc1">More...</a><br /></td></tr>
<tr class="separator:a02cb3895f68b86a4b7e259c8c098ecc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a02cb3895f68b86a4b7e259c8c098ecc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gscond </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>prsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>cwm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>psp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>qp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>psp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im,km)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>lprnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ipr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ix,im</td><td>integer, 1, horizontal dimension and num of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>integer, 1, vertical layer dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>real, 1, physics time step in seconds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dtf</td><td>real, 1, dynamics time step in seconds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prsl</td><td>real, (ix,km), mean layer pressure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ps</td><td>real, (im), surface pressure (Pa) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>real, (ix,km), updated tracers (gq0(:,:,1)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cwm</td><td>real, (ix,km), updated tracers (gq0(:,:,ntcw)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>real, (ix,km), updated temperature </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tp</td><td>real, (ix,km), see phy_f3d(:,:,1) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qp</td><td>real, (ix,km), see phy_f3d(:,:,2) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">psp</td><td>real, (im), see phy_f2d(:,1) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tp1</td><td>real, (ix,km), see phy_f3d(:,:,3) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qp1</td><td>real, (ix,km), see phy_f3d(:,:,4) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">psp1</td><td>real, (im), see phy_f2d(:,2) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>real, (im,km), the critical value of relative humidity for large-scale condensation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lprnt</td><td>logical print flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipr</td><td>integer, 1, check print point for debugging </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="general"></a>
General Algorithm</h1>
<ol type="1">
<li>Compute ice-water id number IW.<ul>
<li>see Table 2 in Zhao and Carr (1997): The distinction between cloud water and cloud ice is made by the cloud identification number IW, which is zero for cloud water and unity for cloud ice.</li>
<li>All clouds are defined to consist of liquid water below the freezing level ( \(T&gt;0^oC\)) and of ice particles above the \(T=-15^oC\) level.</li>
<li>In the temperature region between these two, clouds may be either cloud water or cloud ice. If there are cloud ice particles above this point at the previous or current time step, or if the cloud at this point at the previous time step consists of ice particles, then the cloud substance at this point should also be ice particles because of the cloud seeding effect and the cloud memory of its content.</li>
<li>Otherwise, all clouds in this region are considered to contain supercooled cloud water.</li>
</ul>
</li>
<li>Condensation and evaporation of cloud<ul>
<li>Compute at,aq and ap, which are the changes in t,q and p caused by all the processes except grid-scale condensation and evaporation.</li>
<li>Compute the satuation specific humidity and the relative humidity</li>
<li>According to Sunqvist et al. (1989), cloud fraction \(b\) at a grid point can be estimated from relative humidity using the equation <p class="formulaDsp">
\[ b=1-\left ( \frac{f_{s}-f}{f_{s}-f_{0}} \right )^{1/2} \]
</p>
 for \(f&gt;f_{0}\), and \(ccr=0\) for \(f&lt;f_{0}\). where \(f_{s}=1.0\) is the relative humidity in a cloud region. \(f_{0}\) is the critical value of relative humidity for large-scale condensation. <br />
 Since both temperature and moisture may vary at scales smaller than model grid scale, it is possible for condensation to occur before the grid-average relative humidity reaches 100%. Therefore \(f_{0}\) needs to be less than 1.0 to account for the subgrid-scale variation of temperature and moisture fields.</li>
<li>If cloud cover \(\leq \) cclimitm then evaporate any existing cloud condensate ( \(E_{c}\)) <br />
 If \(q_{0}\) represents the specific humidity at relative humidity \(f_{0}\), then <p class="formulaDsp">
\[ q_{0}=f_{0}q_{s} \]
</p>
 <br />
 if the cloud water/ice at this point is enough to be evaporated until \(f_{0}\) is reached, then the evaporation rate \(E_{c}\), if we assume that the evaporation process occurs in one time step, is determined by <p class="formulaDsp">
\[ E_{c}=\frac{q_{0}-q}{\triangle t} \]
</p>
 <br />
 using \(q_{0}=f_{0}q_{s}\) and the equation \(q=fq_{s}\), \(E_{c}\) then becomes <p class="formulaDsp">
\[ E_{c}=\frac{q_{s}}{\triangle t}(f_{0}-f) \]
</p>
 where \(\triangle t\) is the time step for precipitation calculation in the model.It is a simplified version of a higher-order cloud evaporation algorithm (Rutledge and Hobbs 1983).</li>
<li>If cloud over &gt; cclimit, condense water vapor in to cloud condensate ( \(C_{g}\)) <br />
 Following Sundqvist et al.(1989), the grid-scale condensation rate is solving ( \(C_{g}\)) from Eqs (6) and (7) with equations \(q=fq_{s}\), \(q_{s}=\epsilon e_{s}/p\), and the Clausius-Clapeyron equation \(de_{s}/dT=\epsilon Le_{s}/RT^{2}\),where \(q_{s}\) is the saturation specific humidity, \(e_{s}\) is the saturation vapor pressure, \(R\) is the specific gas constant for dry air, \(P\) is the pressure, \(f\) is the relative humidity, and \(\epsilon=0.622\). The expression for \(C_{g}\) has the form <p class="formulaDsp">
\[ C_{g}=\frac{M-q_{s}f_{t}}{1+(f\epsilon L^{2}q_{s}/RC_{p}T^{2})}+E_{c} \]
</p>
 where <p class="formulaDsp">
\[ M=A_{q}-\frac{f\epsilon Lq_{s}}{RT^{2}}A_{t}+\frac{fq_{s}\partial p}{p\partial t} \]
</p>
 To close the system, an equation for relative humidity tendency \(f_{t}\) was derived by Sundqvist et al. (1989) using the hypothesis that the quantity \(M+E_{c}\) is divided into one part, \(bM\),which condenses in the already cloudy portion of a grid square, and another part, \((1-b)M+E_{c}\),which is used to increase the relative humidity of the cloud-free portion and to increase the cloudiness in the square. The equation is written as <p class="formulaDsp">
\[ f_{t}=\frac{2(1-b)(f_{s}-f_{0})[(1-b)M+E_{c}]}{2q_{s}(1-b)(f_{s}-f_{0})+m/b} \]
</p>
</li>
<li>Check &amp; correct if over condensation occurs</li>
<li>Update of t, q and cwm (see Eqs(6),(7) in Zhao and Carr (1997)) <p class="formulaDsp">
\[ cwm=cwm+(C_{g}-E_{c})\times dt \]
</p>
 <p class="formulaDsp">
\[ q=q-(C_{g}-E_{c})\times dt \]
</p>
 <p class="formulaDsp">
\[ t=t+\frac{L}{C_{p}}(C_{g}-E_{c})\times dt \]
</p>
 <br />
 where \(L\) is the latent heat of condensation/deposition, \(C_{p}\) is the specific heat of air at constant pressure.</li>
</ul>
</li>
<li>Store \(t\), \(q\), \(ps\) for next time step </li>
</ol>

<p>Definition at line <a class="el" href="gscond_8f_source.html#l00027">27</a> of file <a class="el" href="gscond_8f_source.html">gscond.f</a>.</p>

<p>Referenced by <a class="el" href="gbphys_8f_source.html#l00469">gbphys()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gscond_8f_a02cb3895f68b86a4b7e259c8c098ecc1_icgraph.png" border="0" usemap="#gscond_8f_a02cb3895f68b86a4b7e259c8c098ecc1_icgraph" alt=""/></div>
<map name="gscond_8f_a02cb3895f68b86a4b7e259c8c098ecc1_icgraph" id="gscond_8f_a02cb3895f68b86a4b7e259c8c098ecc1_icgraph">
<area shape="rect" id="node2" href="gbphys_8f.html#a34cd2db09b580c23df51c96d5905a805" title="gbphys" alt="" coords="117,5,181,32"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="gscond_8f.html">gscond.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
