<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Radiation Scheme in CCPP: radiation_gases.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Radiation Scheme in CCPP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('radiation__gases_8f_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">radiation_gases.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="radiation__gases_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!  ==========================================================  !!!!!</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!              &#39;module_radiation_gases&#39;  description           !!!!!</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!  ==========================================================  !!!!!</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!   set up ozone climatological profiles and other constant gas        !</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!   profiles, such as co2, ch4, n2o, o2, and those of cfc gases.  All  !</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!   data are entered as mixing ratio by volume, except ozone which is  !</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!   mass mixing ratio (g/g).                                           !</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!   in the module, the externally callabe subroutines are :            !</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!      &#39;gas_init&#39;   -- initialization                                  !</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!         input:                                                       !</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!           ( me )                                                     !</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!         output:                                                      !</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!           ( none )                                                   !</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!      &#39;gas_update&#39; -- read in data and update with time               !</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!         input:                                                       !</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!           ( iyear, imon, iday, ihour, loz1st, ldoco2, me )           !</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!         output:                                                      !</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!           ( none )                                                   !</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!      &#39;getozn&#39;     -- setup climatological ozone profile              !</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!         input:                                                       !</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">!           ( prslk,xlat,                                              !</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">!             IMAX, LM )                                               !</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">!         output:                                                      !</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">!           ( o3mmr )                                                  !</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">!      &#39;getgases&#39;   -- setup constant gas profiles for LW and SW       !</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">!         input:                                                       !</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">!           ( plvl, xlon, xlat,                                        !</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">!             IMAX, LMAX )                                             !</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">!         output:                                                      !</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">!           ( gasdat )                                                 !</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">!   external modules referenced:                                       !</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">!       &#39;module machine&#39;                    in &#39;machine.f&#39;             !</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">!       &#39;module funcphys&#39;                   in &#39;funcphys.f&#39;            !</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">!       &#39;module physcons&#39;                   in &#39;physcons.f             !</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">!       &#39;module module_iounitdef&#39;           in &#39;iounitdef.f&#39;           !</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">!   unit used for radiative active gases:                              !</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">!      ozone : mass mixing ratio                     (g/g)             !</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">!      co2   : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">!      n2o   : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">!      ch4   : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">!      o2    : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!      co    : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">!      cfc11 : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!      cfc12 : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">!      cfc22 : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">!      ccl4  : volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">!      cfc113: volume mixing ratio                   (p/p)             !</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!   program history:                                                   !</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!     may 2003 - y-t hou     create rad_module.f that collectively     !</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!                  combines several radiation computation supporting   !</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!                  programs into fortran 90 module structure (gases    !</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">!                  and aerosols, etc.)                                 !</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">!     apr 2004 - y-t hou     modified to add astronomy and surface     !</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">!                  module components.                                  !</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">!     feb 2005 - y-t hou     rewrite the component modules into        !</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">!                  separate individule modules for thier corresponding !</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">!                  tasks. here as radiation_gases.f                    !</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">!     mar 2006 - y-t hou     add initialization subroutine to co2 and  !</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">!                  other gases. historical 2-d co2 data are added.     !</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">!     sep 2008 - y-t hou     add parameter ictm to control the input   !</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">!                  data time at the model initial condition.           !</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">!     oct 2008 - y-t hou     modify the initialization code to add the !</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">!                  option of superimposing climatology seasonal cycle  !</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">!                  to the initial condition data (currently co2 only)  !</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">!     nov 2008 - y-t hou     fix bugs in superimposing climatology     !</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!                  seasonal cycle calculations                         !</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">!     aug 2011 - y-t hou     fix a bug in subr getgases doing vertical !</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!                  co2 mapping. (for iflip=0 case, not affact opr).    !</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">!     aug 2012 - y-t hou     modified subr getozn.  moved the if-first !</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">!                  block to subr gas_init to ensure threading safe in  !</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">!                  climatology ozone applications. (not affect gfs)    !</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">!                  also changed the initialization subr into two parts:!</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">!                  &#39;gas_init&#39; is called at the start of run to set up  !</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">!                  module parameters; and &#39;gas_update&#39; is called within!</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">!                  the time loop to check and update data sets. defined!</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">!                  the climatology ozone parameters k1oz,k2oz,facoz as !</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">!                  module variables and are set in subr &#39;gas_update&#39;   !</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">!     nov 2012 - y-t hou     modified control parameters thru module   !</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">!                  &#39;physparam&#39;.                                        !</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">!     jan 2013 - z. janjic/y. hou   modified ilon (longitude index)    !</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">!                  computing formula in subroutine getgases to work    !</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">!                  properly for models with either of  0-&gt;360 or       !</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">!                  -180-&gt;180 zonal grid directions.                    !</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">!                                                                      !</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">!!!!!  ==========================================================  !!!!!</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">!!!!!                       end descriptions                       !!!!!</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">!!!!!  ==========================================================  !!!!!</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">!========================================!</span></div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html">  106</a></span>&#160;      <span class="keyword">module</span> <a class="code" href="namespacemodule__radiation__gases.html">module_radiation_gases</a>      <span class="comment">!</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">!........................................!</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacephysparam.html">physparam</a><span class="keywordtype">,         only</span> : <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a>, <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a>, <a class="code" href="namespacephysparam.html#a90d63a1a0c04479f586ce21df72d36b7">ioznflg</a>, <a class="code" href="namespacephysparam.html#a7318a941744b1ec62dc9a6ff5bfbb50d">ivflip</a>,  &amp;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;     &amp;                              <a class="code" href="namespacephysparam.html#abed249e396bbc5c096408db58b5104c0">co2dat_file</a>, <a class="code" href="namespacephysparam.html#ad3e0f053cd067945bdc816b1a81a859a">co2gbl_file</a>,           &amp;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;     &amp;                              <a class="code" href="namespacephysparam.html#a2af9769060fccf9c42e14a30cf21c0aa">co2usr_file</a>, <a class="code" href="namespacephysparam.html#afe0dc3a936d79b4d7dd58fe29376cb1a">co2cyc_file</a>,           &amp;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;     &amp;                              kind_phys, kind_io4</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordtype">use </span>funcphys<span class="keywordtype">,          only</span> : fpkapx</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacephyscons.html">physcons</a><span class="keywordtype">,          only</span> : <a class="code" href="namespacephyscons.html#aeb280391512de20933b4af3593a8ba38">con_pi</a></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordtype">use </span>ozne_def<span class="keywordtype">,          only</span> : jmr =&gt; latsozc, loz =&gt; levozc,      &amp;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     &amp;                              blte =&gt; blatc, dlte=&gt; dphiozc,      &amp;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     &amp;                              timeozc =&gt; timeozc</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">use </span>module_iounitdef<span class="keywordtype">,  only</span> : nio3clm, nico2cn</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordtype">implicit   none</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordtype">private</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">!  ---  version tag and last revision date</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a8a79a6d3d931da021cd19290c58bdfaa">  125</a></span>&#160;      <span class="keywordtype">character(40)</span>, <span class="keywordtype">parameter</span> ::                                       &amp;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     &amp;   VTAGGAS=<span class="stringliteral">&#39;NCEP-Radiation_gases     v5.1  Nov 2012 &#39;</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">!    &amp;   VTAGGAS=&#39;NCEP-Radiation_gases     v5.0  Aug 2012 &#39;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">!  ---  parameter constants</span></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#affc350828412da77ff3cf3e617ddc66c">  131</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span>, <span class="keywordtype">public</span> :: <a class="code" href="namespacemodule__radiation__gases.html#affc350828412da77ff3cf3e617ddc66c">nf_vgas</a> = 10     <span class="comment">! number of gas species</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">  133</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span>         :: <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a>  = 24     <span class="comment">! input co2 data lon points</span></div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">  135</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span>         :: <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a>  = 12     <span class="comment">! input co2 data lat points</span></div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a3b26af64187b57999cadeced419b0f1b">  137</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span>         :: <a class="code" href="namespacemodule__radiation__gases.html#a3b26af64187b57999cadeced419b0f1b">minyear</a> = 1957   <span class="comment">! earlist year 2-d co2 data</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                                     <span class="comment">! available</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#afda5c1d1129d865b9772e0f58dea7598">  140</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#afda5c1d1129d865b9772e0f58dea7598">resco2</a>=15.0         <span class="comment">! horiz res in degree</span></div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#aa5873ae54e950001ff873771378e7a1e">  141</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#aa5873ae54e950001ff873771378e7a1e">raddeg</a>=180.0/<a class="code" href="namespacephyscons.html#aeb280391512de20933b4af3593a8ba38">con_pi</a> <span class="comment">! rad-&gt;deg conversion</span></div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#ab09dc05b8a02e9a0b56991508b599708">  142</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#ab09dc05b8a02e9a0b56991508b599708">prsco2</a>=788.0        <span class="comment">! pres lim for 2-d co2 (mb)</span></div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#ab99c75954c59ed92a52de94ca6113f73">  143</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#ab99c75954c59ed92a52de94ca6113f73">hfpi</a>  =0.5*<a class="code" href="namespacephyscons.html#aeb280391512de20933b4af3593a8ba38">con_pi</a>   <span class="comment">! half of pi</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">!  ---  parameter constants for gas volume mixing ratioes</span></div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a4fb5ca2e3bfaed7848d7602a22499e76">  146</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a4fb5ca2e3bfaed7848d7602a22499e76">co2vmr_def</a> = 350.0e-6</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a858ad802efe755f8b4b5bde85996b6ae">  147</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a858ad802efe755f8b4b5bde85996b6ae">n2ovmr_def</a> = 0.31e-6</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#aad928d9e0064905a0b6e1eb8bb59bd23">  148</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#aad928d9e0064905a0b6e1eb8bb59bd23">ch4vmr_def</a> = 1.50e-6</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a910898e96b8afe92ebc82ce62ba682d8">  149</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a910898e96b8afe92ebc82ce62ba682d8">o2vmr_def</a>  = 0.209</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a3554bdf03f8222d425bb6c946244cbb5">  150</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a3554bdf03f8222d425bb6c946244cbb5">covmr_def</a>  = 1.50e-8</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a23ae6bb6860bfefef0c281b7106f521e">  151</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a23ae6bb6860bfefef0c281b7106f521e">f11vmr_def</a> = 3.520e-10   <span class="comment">! aer 2003 value</span></div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a96d4f78070f30010626e0824b3421250">  152</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a96d4f78070f30010626e0824b3421250">f12vmr_def</a> = 6.358e-10   <span class="comment">! aer 2003 value</span></div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#afd0018e96811ac64ef2abd8cab821eb5">  153</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#afd0018e96811ac64ef2abd8cab821eb5">f22vmr_def</a> = 1.500e-10   <span class="comment">! aer 2003 value</span></div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a013f8faaee6df0c7c032e1786770c110">  154</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a013f8faaee6df0c7c032e1786770c110">cl4vmr_def</a> = 1.397e-10   <span class="comment">! aer 2003 value</span></div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a76ec88dc6284c48cfaae6cd05428b6dd">  155</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a76ec88dc6284c48cfaae6cd05428b6dd">f113vmr_def</a>= 8.2000e-11  <span class="comment">! gfdl 1999 value</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">!  ---  ozone seasonal climatology parameters defined in module ozne_def</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">!   - 4x5 ozone data parameter</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">!     integer, parameter :: JMR=45, LOZ=17</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">!     real (kind=kind_phys), parameter :: blte=-86.0, dlte=4.0</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">!   - geos ozone data</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">!     integer, parameter :: JMR=18, LOZ=17</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">!     real (kind=kind_phys), parameter :: blte=-85.0, dlte=10.0</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">!  ---  module variables to be set in subroutin gas_init and/or gas_update</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">!   - variables for climatology ozone (ioznflg = 0)</span></div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">  168</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(:), <a class="code" href="namespacemodule__radiation__gases.html#ad18392d991a9ef4b6ff0e8e822176a18">o3r</a>(:,:,:)</div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a0c3727c9e2a0bec46e84622c4591cd8b">  169</a></span>&#160;      <span class="keywordtype">integer</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a> = 0,  <a class="code" href="namespacemodule__radiation__gases.html#a0c3727c9e2a0bec46e84622c4591cd8b">k2oz</a> = 0</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#ac7c9fd8ece69872fdef473020ea03d6b">  170</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: <a class="code" href="namespacemodule__radiation__gases.html#ac7c9fd8ece69872fdef473020ea03d6b">facoz</a> = 0.0</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">!   - arrays for co2 2-d monthly data and global mean values from observed data</span></div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">  173</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(:,:,:)</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a3985e306e5555089909fd42a4cc93afb">  174</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a3985e306e5555089909fd42a4cc93afb">co2cyc_sav</a>(:,:,:)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">  176</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a> = <a class="code" href="namespacemodule__radiation__gases.html#a4fb5ca2e3bfaed7848d7602a22499e76">co2vmr_def</a></div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">  177</a></span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(12)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keyword">data</span> <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(:) / 12*0.0 /</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a6b4372e633bef3fb367e6ff3cf200bb8">  180</a></span>&#160;      <span class="keywordtype">integer</span> :: <a class="code" href="namespacemodule__radiation__gases.html#a6b4372e633bef3fb367e6ff3cf200bb8">kyrsav</a>  = 0</div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">  181</a></span>&#160;      <span class="keywordtype">integer</span> :: <a class="code" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">kmonsav</a> = 1</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">!  ---  public interfaces</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordtype">public</span>  <a class="code" href="namespacemodule__radiation__gases.html#a1def261c0ef5d5408658c87b6dc08b53">gas_init</a>, <a class="code" href="namespacemodule__radiation__gases.html#a064db1c287e8614ae7efd6b4fac91a6b">gas_update</a>, <a class="code" href="namespacemodule__radiation__gases.html#ad06401a54d361b3dd852d815d1b0f71e">getgases</a>, <a class="code" href="namespacemodule__radiation__gases.html#af4be311f1ec1601a167655c1632d66de">getozn</a></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">! =================</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keyword">contains</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">! =================</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">!-----------------------------------</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemodule__radiation__gases.html#a1def261c0ef5d5408658c87b6dc08b53">gas_init</a>                                               &amp;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">!...................................</span></div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a1def261c0ef5d5408658c87b6dc08b53">  217</a></span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;     &amp;     ( me )</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">!  ---  outputs: ( none )</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">!  ===================================================================  !</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">!  gas_init sets up ozone, co2, etc. parameters.  if climatology ozone  !</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">!  then read in monthly ozone data.                                     !</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">!  inputs:                                               dimemsion      !</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">!     me      - print message control flag                  1           !</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">!  outputs: (to the module variables)                                   !</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">!    ( none )                                                           !</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">!  external module variables:  (in physparam)                           !</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">!     ico2flg    - co2 data source control flag                         !</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">!                   =0: use prescribed co2 global mean value            !</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">!                   =1: use input global mean co2 value (co2_glb)       !</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">!                   =2: use input 2-d monthly co2 value (co2vmr_sav)    !</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">!     ictmflg    - =yyyy#, data ic time/date control flag               !</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">!                  =   -2: same as 0, but superimpose seasonal cycle    !</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">!                          from climatology data set.                   !</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">!                  =   -1: use user provided external data for the fcst !</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">!                          time, no extrapolation.                      !</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">!                  =    0: use data at initial cond time, if not existed!</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">!                          then use latest, without extrapolation.      !</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">!                  =    1: use data at the forecast time, if not existed!</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">!                          then use latest and extrapolate to fcst time.!</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">!                  =yyyy0: use yyyy data for the forecast time, no      !</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">!                          further data extrapolation.                  !</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">!                  =yyyy1: use yyyy data for the fcst. if needed, do    !</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">!                          extrapolation to match the fcst time.        !</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">!     ioznflg    - ozone data control flag                              !</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">!                   =0: use climatological ozone profile                !</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">!                   &gt;0: use interactive ozone profile                   !</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">!     ivflip     - vertical profile indexing flag                       !</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">!     co2usr_file- external co2 user defined data table                 !</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">!     co2cyc_file- external co2 climotology monthly cycle data table    !</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">!  internal module variables:                                           !</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">!     pkstr, o3r - arrays for climatology ozone data                    !</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">!  usage:    call gas_init                                              !</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">!  subprograms called:  none                                            !</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">!  ===================================================================  !</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: me</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">!  ---  output: ( none )</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">!  ---  locals:</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">dimension(IMXCO2,JMXCO2)</span> :: co2dat</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: co2g1, co2g2</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: pstr(loz)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordtype">real (kind=kind_io4)</span>  :: o3clim4(jmr,loz,12), pstr4(loz)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordtype">integer</span>    :: imond(12), ilat(jmr,12)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordtype">integer</span>    :: i, j, k, iyr, imo</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordtype">logical</span>    :: file_exist, lextpl</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordtype">character</span>  :: cline*100, cform*8</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keyword">data</span>  cform  / <span class="stringliteral">&#39;(24f7.2)&#39;</span> /       <span class="comment">!! data format in IMXCO2*f7.2</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">!===&gt;  ...  begin here</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">if</span> ( me == 0 ) print *, <a class="code" href="namespacemodule__radiation__gases.html#a8a79a6d3d931da021cd19290c58bdfaa">vtaggas</a>    <span class="comment">! print out version tag</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <a class="code" href="namespacemodule__radiation__gases.html#a6b4372e633bef3fb367e6ff3cf200bb8">kyrsav</a>  = 0</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <a class="code" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">kmonsav</a> = 1</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">!  --- ...  climatology ozone data section</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a90d63a1a0c04479f586ce21df72d36b7">ioznflg</a> &gt; 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          print *,<span class="stringliteral">&#39; - Using interactive ozone distribution&#39;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span> ( timeozc /= 12 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          print *,<span class="stringliteral">&#39; - Using climatology ozone distribution&#39;</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          print *,<span class="stringliteral">&#39; timeozc=&#39;</span>,timeozc, <span class="stringliteral">&#39; is not monthly mean&#39;</span>,          &amp;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;     &amp;            <span class="stringliteral">&#39; - job aborting in subroutin gas_init!!!&#39;</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          stop</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keyword">allocate</span> (<a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(loz), <a class="code" href="namespacemodule__radiation__gases.html#ad18392d991a9ef4b6ff0e8e822176a18">o3r</a>(jmr,loz,12))</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        rewind nio3clm</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">if</span> ( loz == 17 ) <span class="keywordflow">then</span>       <span class="comment">! For the operational ozone climatology</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <span class="keywordflow">do</span> k = 1, loz</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keyword">read</span> (nio3clm,15) pstr4(k)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   15       <span class="keyword">format</span>(f10.3)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">do</span> j = 1, jmr</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;              <span class="keyword">read</span> (nio3clm,16) imond(imo), ilat(j,imo),                &amp;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;     &amp;                          (o3clim4(j,k,imo),k=1,10)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   16         <span class="keyword">format</span>(i2,i4,10f6.2)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;              <span class="keyword">read</span> (nio3clm,20) (o3clim4(j,k,imo),k=11,loz)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   20         <span class="keyword">format</span>(6x,10f6.2)</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">else</span>                      <span class="comment">! For newer ozone climatology</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <span class="keyword">read</span> (nio3clm)</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="keywordflow">do</span> k = 1, loz</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keyword">read</span> (nio3clm) pstr4(k)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">do</span> k = 1, loz</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;              <span class="keyword">read</span> (nio3clm) (o3clim4(j,k,imo),j=1,jmr)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">        endif</span>   <span class="comment">! end if_LOZ_block</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          <span class="keywordflow">do</span> k = 1, loz</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">do</span> j = 1, jmr</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;              <a class="code" href="namespacemodule__radiation__gases.html#ad18392d991a9ef4b6ff0e8e822176a18">o3r</a>(j,k,imo) = o3clim4(j,k,imo) * 1.655e-6</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">do</span> k = 1, loz</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          pstr(k) = pstr4(k)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          print *,<span class="stringliteral">&#39; - Using climatology ozone distribution&#39;</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          print *,<span class="stringliteral">&#39;   Found ozone data for levels pstr=&#39;</span>,               &amp;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     &amp;            (pstr(k),k=1,loz)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">!         print *,&#39; O3=&#39;,(o3r(15,k,1),k=1,LOZ)</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">do</span> k = 1, loz</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          <a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(k) = fpkapx(pstr(k)*100.0)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordflow">      endif</span>   <span class="comment">! end if_ioznflg_block</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">!  --- ...  co2 data section</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a> = <a class="code" href="namespacemodule__radiation__gases.html#a4fb5ca2e3bfaed7848d7602a22499e76">co2vmr_def</a></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      lab_ico2 : <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          print *,<span class="stringliteral">&#39; - Using prescribed co2 global mean value=&#39;</span>,         &amp;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     &amp;              <a class="code" href="namespacemodule__radiation__gases.html#a4fb5ca2e3bfaed7848d7602a22499e76">co2vmr_def</a></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordflow">else</span>  lab_ico2</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        lab_ictm : <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a> == -1 ) <span class="keywordflow">then</span>      <span class="comment">! input user provided data</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          <span class="keyword">inquire</span> (file=<a class="code" href="namespacephysparam.html#a2af9769060fccf9c42e14a30cf21c0aa">co2usr_file</a>, exist=file_exist)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          <span class="keywordflow">if</span> ( .not. file_exist ) <span class="keywordflow">then</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            print *,<span class="stringliteral">&#39;   Can not find user CO2 data file: &#39;</span>,<a class="code" href="namespacephysparam.html#a2af9769060fccf9c42e14a30cf21c0aa">co2usr_file</a>, &amp;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;     &amp;              <span class="stringliteral">&#39; - Stopped in subroutine gas_init !!&#39;</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            stop</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keyword">close</span> (nico2cn)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keyword">open</span>(nico2cn,file=<a class="code" href="namespacephysparam.html#a2af9769060fccf9c42e14a30cf21c0aa">co2usr_file</a>,form=<span class="stringliteral">&#39;formatted&#39;</span>,status=<span class="stringliteral">&#39;old&#39;</span>)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            rewind nico2cn</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keyword">read</span> (nico2cn, 25) iyr, cline, co2g1, co2g2</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  25        <span class="keyword">format</span>(i4,a94,f7.2,16x,f5.2)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a> = co2g1 * 1.0e-6</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;              <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                print *,<span class="stringliteral">&#39; - Using co2 global annual mean value from&#39;</span>,   &amp;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;     &amp;                  <span class="stringliteral">&#39; user provided data set:&#39;</span>,<a class="code" href="namespacephysparam.html#a2af9769060fccf9c42e14a30cf21c0aa">co2usr_file</a></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                print *, iyr,cline(1:94),co2g1,<span class="stringliteral">&#39;  GROWTH RATE =&#39;</span>, co2g2</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">elseif</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;              <span class="keyword">allocate</span> ( <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(<a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a>,<a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a>,12) )</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;              <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                <span class="keyword">read</span> (nico2cn,cform) co2dat</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">!check          print cform, co2dat</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">do</span> j = 1, <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                  <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(i,j,imo) = co2dat(i,j) * 1.0e-6</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordflow">                  enddo</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;              <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                print *,<span class="stringliteral">&#39; - Using co2 monthly 2-d data from user&#39;</span>,      &amp;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;     &amp;                <span class="stringliteral">&#39; provided data set:&#39;</span>,<a class="code" href="namespacephysparam.html#a2af9769060fccf9c42e14a30cf21c0aa">co2usr_file</a></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                print *, iyr,cline(1:94),co2g1,<span class="stringliteral">&#39;  GROWTH RATE =&#39;</span>, co2g2</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                print *,<span class="stringliteral">&#39; CHECK: Sample of selected months of CO2 data&#39;</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keywordflow">do</span> imo = 1, 12, 3</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                  print *,<span class="stringliteral">&#39;        Month =&#39;</span>,imo</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                  print *, <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(1,:,imo)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;              print *,<span class="stringliteral">&#39; ICO2=&#39;</span>,<a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a>,<span class="stringliteral">&#39; is not a valid selection&#39;</span>,     &amp;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;     &amp;                <span class="stringliteral">&#39; - Stoped in subroutine gas_init!!!&#39;</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;              stop</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keywordflow">            endif</span>    <span class="comment">! endif_ico2flg_block</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keyword">close</span> (nico2cn)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordflow">          endif</span>    <span class="comment">! endif_file_exist_block</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">else</span>   lab_ictm                           <span class="comment">! input from observed data</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;              print *,<span class="stringliteral">&#39; - Using observed co2 global annual mean value&#39;</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordflow">            endiF</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          <span class="keywordflow">elseif</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keyword">allocate</span> ( <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(<a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a>,<a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a>,12) )</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;              print *,<span class="stringliteral">&#39; - Using observed co2 monthly 2-d data&#39;</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            print *,<span class="stringliteral">&#39; ICO2=&#39;</span>,<a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a>,<span class="stringliteral">&#39; is not a valid selection&#39;</span>,       &amp;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;     &amp;              <span class="stringliteral">&#39; - Stoped in subroutine gas_init!!!&#39;</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            stop</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a> == -2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keyword">inquire</span> (file=<a class="code" href="namespacephysparam.html#afe0dc3a936d79b4d7dd58fe29376cb1a">co2cyc_file</a>, exist=file_exist)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">if</span> ( .not. file_exist ) <span class="keywordflow">then</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;              <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                print *,<span class="stringliteral">&#39;   Can not find seasonal cycle CO2 data: &#39;</span>,    &amp;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;     &amp;               <a class="code" href="namespacephysparam.html#afe0dc3a936d79b4d7dd58fe29376cb1a">co2cyc_file</a>,<span class="stringliteral">&#39; - Stopped in subroutine gas_init !!&#39;</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;              stop</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;              <span class="keyword">allocate</span>( <a class="code" href="namespacemodule__radiation__gases.html#a3985e306e5555089909fd42a4cc93afb">co2cyc_sav</a>(<a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a>,<a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a>,12) )</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">!  --- ...  read in co2 2-d seasonal cycle data</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;              <span class="keyword">close</span> (nico2cn)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;              <span class="keyword">open</span> (nico2cn,file=<a class="code" href="namespacephysparam.html#afe0dc3a936d79b4d7dd58fe29376cb1a">co2cyc_file</a>,form=<span class="stringliteral">&#39;formatted&#39;</span>,          &amp;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;     &amp;              status=<span class="stringliteral">&#39;old&#39;</span>)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;              rewind nico2cn</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;              <span class="keyword">read</span> (nico2cn, 35) cline, co2g1, co2g2</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  35          <span class="keyword">format</span>(a98,f7.2,16x,f5.2)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;              <span class="keyword">read</span> (nico2cn,cform) co2dat        <span class="comment">! skip annual mean part</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;              <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                print *,<span class="stringliteral">&#39; - Superimpose seasonal cycle to mean CO2 data&#39;</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                print *,<span class="stringliteral">&#39;   Opened CO2 climatology seasonal cycle data&#39;</span>,&amp;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;     &amp;                  <span class="stringliteral">&#39; file: &#39;</span>,<a class="code" href="namespacephysparam.html#afe0dc3a936d79b4d7dd58fe29376cb1a">co2cyc_file</a></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">!check          print *, cline(1:98), co2g1, co2g2</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keyword">read</span> (nico2cn,45) cline, <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(imo)</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  45            <span class="keyword">format</span>(a58,f7.2)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">!check          print *, cline(1:58),gco2cyc(imo)</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(imo) = <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(imo) * 1.0e-6</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="keyword">read</span> (nico2cn,cform) co2dat</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">!check          print cform, co2dat</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="keywordflow">do</span> j = 1, <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                  <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <a class="code" href="namespacemodule__radiation__gases.html#a3985e306e5555089909fd42a4cc93afb">co2cyc_sav</a>(i,j,imo) = co2dat(i,j) * 1.0e-6</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordflow">                  enddo</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;              <span class="keyword">close</span> (nico2cn)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordflow">            endif</span>   <span class="comment">! endif_file_exist_block</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">        endif</span>   lab_ictm</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordflow">      endif</span>   lab_ico2</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">!...................................</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemodule__radiation__gases.html#a1def261c0ef5d5408658c87b6dc08b53">gas_init</a></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">!-----------------------------------</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">!!\param[in] iyear      integer, 1, year of the requested data for fcst </span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">!!\param[in] imon       integer, 1, month of the year    </span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">!!\param[in] iday       integer, 1, day of the month      </span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">!!\param[in] ihour      integer, 1, hour of the day </span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">!!\param[in] loz1st     logical, 1, clim ozone 1st time update control flag </span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">!!\param[in] ldoco2     logical, 1, co2 update control flag      </span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">!!\param[in] me         integer, 1, print message control flag</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">!!\param[out] NONE       </span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">!!\section external External Module Variables:</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">!!\n physparam::ico2flg    - co2 data source control flag</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">!!\n                         =0: use prescribed co2 global mean value</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">!!\n                         =1: use input global mean co2 value (co2_glb)</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">!!\n                         =2: use input 2-d monthly co2 value (co2vmr_sav)</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">!!\n physparam::ictmflg    - =yyyy#, data ic time/date control flag</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">!!\n                         =   -2: same as 0, but superimpose seasonal cycle from climatology data set.</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">!!\n                         =   -1: use user provided external data for the fcst time, no extrapolation.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">!!\n                         =    0: use data at initial condition time, if not existed then use latest, without extrapolation.</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">!!\n                         =    1: use data at the forecast time, if not existed then use latest and extrapolate to fcst time.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">!!\n                         =yyyy0: use yyyy data for the forecast time, no further data extrapolation.</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">!!\n                         =yyyy1: use yyyy data for the fcst. if needed, do extrapolation to match the fcst time.</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">!!\n physparam::ioznflg    - ozone data control flag</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">!!\n                         =0: use climatological ozone profile</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">!!\n                         &gt;0: use interactive ozone profile</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">!!\n physparam::ivflip     - vertical profile indexing flag</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">!!\n physparam::co2usr_file   - external co2 user defined data table</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">!!\n physparam::co2cyc_file   - external co2 climotology monthly cycle data table</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">!-----------------------------------</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemodule__radiation__gases.html#a064db1c287e8614ae7efd6b4fac91a6b">gas_update</a>                                             &amp;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">!...................................</span></div><div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#a064db1c287e8614ae7efd6b4fac91a6b">  535</a></span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     &amp;     ( iyear, imon, iday, ihour, loz1st, ldoco2, me )</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">!  ---  outputs: ( none )</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">!  ===================================================================  !</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">!  gas_update reads in 2-d monthly co2 data set for a specified year.   !</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">!  data are in a 15 degree lat/lon horizontal resolution.               !</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">!  inputs:                                               dimemsion      !</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">!     iyear   - year of the requested data for fcst         1           !</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">!     imon    - month of the year                           1           !</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">!     iday    - day of the month                            1           !</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">!     ihour   - hour of the day                             1           !</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">!     loz1st  - clim ozone 1st time update control flag     1           !</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">!     ldoco2  - co2 update control flag                     1           !</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">!     me      - print message control flag                  1           !</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">!  outputs: (to the module variables)                                   !</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">!    ( none )                                                           !</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">!  external module variables:  (in physparam)                           !</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">!     ico2flg    - co2 data source control flag                         !</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">!                   =0: use prescribed co2 global mean value            !</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">!                   =1: use input global mean co2 value (co2_glb)       !</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">!                   =2: use input 2-d monthly co2 value (co2vmr_sav)    !</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">!     ictmflg    - =yyyy#, data ic time/date control flag               !</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">!                  =   -2: same as 0, but superimpose seasonal cycle    !</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">!                          from climatology data set.                   !</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">!                  =   -1: use user provided external data for the fcst !</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">!                          time, no extrapolation.                      !</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">!                  =    0: use data at initial cond time, if not existed!</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">!                          then use latest, without extrapolation.      !</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">!                  =    1: use data at the forecast time, if not existed!</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">!                          then use latest and extrapolate to fcst time.!</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">!                  =yyyy0: use yyyy data for the forecast time, no      !</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">!                          further data extrapolation.                  !</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">!                  =yyyy1: use yyyy data for the fcst. if needed, do    !</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">!                          extrapolation to match the fcst time.        !</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">!     ioznflg    - ozone data control flag                              !</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">!                   =0: use climatological ozone profile                !</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">!                   &gt;0: use interactive ozone profile                   !</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">!     ivflip     - vertical profile indexing flag                       !</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">!     co2dat_file- external co2 2d monthly obsv data table              !</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">!     co2gbl_file- external co2 global annual mean data table           !</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">!  internal module variables:                                           !</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">!     co2vmr_sav - monthly co2 volume mixing ratio     IMXCO2*JMXCO2*12 !</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">!     co2cyc_sav - monthly cycle co2 vol mixing ratio  IMXCO2*JMXCO2*12 !</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">!     co2_glb    - global annual mean co2 mixing ratio                  !</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">!     gco2cyc    - global monthly mean co2 variation       12           !</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">!     k1oz,k2oz,facoz                                                   !</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">!                - climatology ozone parameters             1           !</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">!  usage:    call gas_update                                            !</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">!  subprograms called:  none                                            !</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">!  ===================================================================  !</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: iyear, imon, iday, ihour, me</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: loz1st, ldoco2</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">!  ---  output: ( none )</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">!  ---  locals:</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">dimension(IMXCO2,JMXCO2)</span> :: co2dat, co2ann</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: co2g1, co2g2, rate</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordtype">integer</span>    :: i, id, j, l, iyr, imo, iyr1, iyr2, jyr, idyr</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">save</span> :: mdays(13), midmon=15, midm=15, midp=45</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">!  ---  number of days in a month</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keyword">data</span> mdays / 31,28,31,30,31,30,31,31,30,31,30,31,30 /</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordtype">logical</span>    :: file_exist, lextpl, change</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="keywordtype">character</span>  :: cline*100, cform*8, cfile1*26</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keyword">data</span>  cform  / <span class="stringliteral">&#39;(24f7.2)&#39;</span> /       <span class="comment">!! data format in IMXCO2*f7.2</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">!===&gt;  ...  begin here</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">!  --- ...  ozone data section</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a90d63a1a0c04479f586ce21df72d36b7">ioznflg</a> == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        midmon = mdays(imon)/2 + 1</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        change = loz1st .or. ( (iday==midmon) .and. (ihour==0) )</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">if</span> ( change ) <span class="keywordflow">then</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          <span class="keywordflow">if</span> ( iday &lt; midmon ) <span class="keywordflow">then</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a> = mod(imon+10, 12) + 1</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            midm = mdays(<a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a>)/2 + 1</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <a class="code" href="namespacemodule__radiation__gases.html#a0c3727c9e2a0bec46e84622c4591cd8b">k2oz</a> = imon</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            midp = mdays(<a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a>) + midmon</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a> = imon</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            midm = midmon</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <a class="code" href="namespacemodule__radiation__gases.html#a0c3727c9e2a0bec46e84622c4591cd8b">k2oz</a> = mod(imon, 12) + 1</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            midp = mdays(<a class="code" href="namespacemodule__radiation__gases.html#a0c3727c9e2a0bec46e84622c4591cd8b">k2oz</a>)/2 + 1 + mdays(<a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a>)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">if</span> (iday &lt; midmon) <span class="keywordflow">then</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;         id = iday + mdays(<a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a>)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;         id = iday</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <a class="code" href="namespacemodule__radiation__gases.html#ac7c9fd8ece69872fdef473020ea03d6b">facoz</a> = float(id - midm) / float(midp - midm)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">!  --- ...  co2 data section</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 0 ) <span class="keywordflow">return</span>    <span class="comment">! use prescribed global mean co2 data</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a> ==-1 ) <span class="keywordflow">return</span>    <span class="comment">! use user provided co2 data</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">if</span> ( .not. ldoco2 ) <span class="keywordflow">return</span>    <span class="comment">! no need to update co2 data</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a> &lt; 0 ) <span class="keywordflow">then</span>        <span class="comment">! use user provided external data</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        lextpl = .false.                   <span class="comment">! no time extrapolation</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        idyr   = iyear                     <span class="comment">! use the model year</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">else</span>                           <span class="comment">! use historically observed data</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        lextpl = ( mod(<a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a>,10) == 1 )  <span class="comment">! flag for data extrapolation</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        idyr   = <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a> / 10              <span class="comment">! year of data source used</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">if</span> ( idyr == 0 ) idyr = iyear      <span class="comment">! not specified, use model year</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">!  --- ...  auto select co2 2-d data table for required year</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <a class="code" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">kmonsav</a> = imon</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacemodule__radiation__gases.html#a6b4372e633bef3fb367e6ff3cf200bb8">kyrsav</a> == iyear ) <span class="keywordflow">return</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <a class="code" href="namespacemodule__radiation__gases.html#a6b4372e633bef3fb367e6ff3cf200bb8">kyrsav</a> = iyear</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      iyr    = iyear</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">!  --- ...  for data earlier than MINYEAR (1957), the data are in</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">!           the form of semi-yearly global mean values.  otherwise,</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">!           data are monthly mean in horizontal 2-d map.</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      lab_if_idyr : <span class="keywordflow">if</span> ( idyr &lt; <a class="code" href="namespacemodule__radiation__gases.html#a3b26af64187b57999cadeced419b0f1b">minyear</a> .and. <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a> &gt; 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;          print *,<span class="stringliteral">&#39;   Requested CO2 data year&#39;</span>,iyear,<span class="stringliteral">&#39; earlier than&#39;</span>,   &amp;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;     &amp;            <a class="code" href="namespacemodule__radiation__gases.html#a3b26af64187b57999cadeced419b0f1b">minyear</a></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          print *,<span class="stringliteral">&#39;   Which is the earliest monthly observation&#39;</span>,       &amp;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;     &amp;            <span class="stringliteral">&#39; data available.&#39;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          print *,<span class="stringliteral">&#39;   Thus, historical global mean data is used&#39;</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">!  --- ... check to see if requested co2 data file existed</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keyword">inquire</span> (file=<a class="code" href="namespacephysparam.html#ad3e0f053cd067945bdc816b1a81a859a">co2gbl_file</a>, exist=file_exist)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">if</span> ( .not. file_exist ) <span class="keywordflow">then</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          print *,<span class="stringliteral">&#39;   Requested co2 data file &quot;&#39;</span>,<a class="code" href="namespacephysparam.html#ad3e0f053cd067945bdc816b1a81a859a">co2gbl_file</a>,           &amp;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;     &amp;            <span class="stringliteral">&#39;&quot; not found - Stopped in subroutine gas_update!!&#39;</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          stop</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          <span class="keyword">close</span>(nico2cn)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          <span class="keyword">open</span> (nico2cn,file=<a class="code" href="namespacephysparam.html#ad3e0f053cd067945bdc816b1a81a859a">co2gbl_file</a>,form=<span class="stringliteral">&#39;formatted&#39;</span>,status=<span class="stringliteral">&#39;old&#39;</span>)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          rewind nico2cn</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          <span class="keyword">read</span> (nico2cn, 24) iyr1, iyr2, cline</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  24      <span class="keyword">format</span>(i4,4x,i4,a48)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            print *,<span class="stringliteral">&#39;   Opened co2 data file: &#39;</span>,<a class="code" href="namespacephysparam.html#ad3e0f053cd067945bdc816b1a81a859a">co2gbl_file</a></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">!check      print *, iyr1, iyr2, cline(1:48)</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          <span class="keywordflow">if</span> ( idyr &lt; iyr1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            iyr = iyr1</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">!check      if ( me == 0 ) then</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">!             print *,&#39;   Using earlist available co2 data, year=&#39;,iyr1</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">!check      endif</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          i = iyr2</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          lab_dowhile1 : <span class="keywordflow">do</span> <span class="keywordflow">while</span> ( i &gt;= iyr1 )</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">!           read (NICO2CN,26) jyr, co2g1, co2g2</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">! 26        format(i4,4x,2f7.2)</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keyword">read</span> (nico2cn, *) jyr, co2g1, co2g2</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">if</span> ( i == iyr .and. iyr == jyr ) <span class="keywordflow">then</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;              <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a> = (co2g1+co2g2) * 0.5e-6</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;              <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="keywordflow">do</span> j = 1, <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                  <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(i,j,1:6)  = co2g1 * 1.0e-6</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(i,j,7:12) = co2g2 * 1.0e-6</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="keywordflow">                  enddo</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;              <span class="keywordflow">if</span> ( me == 0 ) print *,<span class="stringliteral">&#39;   Co2 data for year&#39;</span>,iyear,      &amp;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;     &amp;                               <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;              <span class="keywordflow">exit</span> lab_dowhile1</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">!check        if ( me == 0 ) print *,&#39;   Skip co2 data for year&#39;,i</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              i = i - 1</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keywordflow">          enddo</span>  lab_dowhile1</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          <span class="keyword">close</span> ( nico2cn )</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordflow">        endif</span>   <span class="comment">! end if_file_exist_block</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keywordflow">else</span>  lab_if_idyr</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">!  --- ...  set up input data file name</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        cfile1 = <a class="code" href="namespacephysparam.html#abed249e396bbc5c096408db58b5104c0">co2dat_file</a></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keyword">write</span>(cfile1(19:22),34) idyr</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  34    <span class="keyword">format</span>(i4.4)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">!  --- ... check to see if requested co2 data file existed</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keyword">inquire</span> (file=cfile1, exist=file_exist)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">if</span> ( .not. file_exist ) <span class="keywordflow">then</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          lab_if_ictm : <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a>  &gt; 10 ) <span class="keywordflow">then</span>    <span class="comment">! specified year of data not found</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;              print *,<span class="stringliteral">&#39;   Specified co2 data for year&#39;</span>,idyr,            &amp;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;     &amp;               <span class="stringliteral">&#39; not found !!  Need to change namelist ICTM !!&#39;</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;              print *,<span class="stringliteral">&#39;   *** Stopped in subroutine gas_update !!&#39;</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            stop</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          <span class="keywordflow">else</span> lab_if_ictm                        <span class="comment">! looking for latest available data</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;              print *,<span class="stringliteral">&#39;   Requested co2 data for year&#39;</span>,idyr,            &amp;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;     &amp;              <span class="stringliteral">&#39; not found, check for other available data set&#39;</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            lab_dowhile2 : <span class="keywordflow">do</span> <span class="keywordflow">while</span> ( iyr &gt;= <a class="code" href="namespacemodule__radiation__gases.html#a3b26af64187b57999cadeced419b0f1b">minyear</a> )</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;              iyr = iyr - 1</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;              <span class="keyword">write</span>(cfile1(19:22),34) iyr</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;              <span class="keyword">inquire</span> (file=cfile1, exist=file_exist)</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;              <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                print *,<span class="stringliteral">&#39; Looking for CO2 file &#39;</span>,cfile1</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;              <span class="keywordflow">if</span> ( file_exist ) <span class="keywordflow">then</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="keywordflow">exit</span> lab_dowhile2</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keywordflow">            enddo</span>   lab_dowhile2</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordflow">if</span> ( .not. file_exist ) <span class="keywordflow">then</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;              <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                print *,<span class="stringliteral">&#39;   Can not find co2 data source file&#39;</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                print *,<span class="stringliteral">&#39;   *** Stopped in subroutine gas_update !!&#39;</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;              stop</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="keywordflow">          endif</span>  lab_if_ictm</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="keywordflow">        endif</span>   <span class="comment">! end if_file_exist_block</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">!  --- ...  read in co2 2-d data for the requested month</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keyword">close</span>(nico2cn)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keyword">open</span> (nico2cn,file=cfile1,form=<span class="stringliteral">&#39;formatted&#39;</span>,status=<span class="stringliteral">&#39;old&#39;</span>)</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        rewind nico2cn</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keyword">read</span> (nico2cn, 36) iyr, cline, co2g1, co2g2</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  36    <span class="keyword">format</span>(i4,a94,f7.2,16x,f5.2)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          print *,<span class="stringliteral">&#39;   Opened co2 data file: &#39;</span>,cfile1</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;          print *, iyr, cline(1:94), co2g1,<span class="stringliteral">&#39;  GROWTH RATE =&#39;</span>, co2g2</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">!  --- ...  add growth rate if needed</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">if</span> ( lextpl ) <span class="keywordflow">then</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">!         rate = co2g2 * (iyear - iyr)   ! rate from early year</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">!         rate = 1.60  * (iyear - iyr)   ! avg rate over long period</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;          rate = 2.00  * (iyear - iyr)   <span class="comment">! avg rate for recent period</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;          rate = 0.0</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a> = (co2g1 + rate) * 1.0e-6</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          print *,<span class="stringliteral">&#39;   Global annual mean CO2 data for year&#39;</span>,            &amp;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;     &amp;              iyear, <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">ictmflg</a> == -2 ) <span class="keywordflow">then</span>     <span class="comment">! need to calc ic time annual mean first</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="keywordflow">if</span> ( me==0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;              print *,<span class="stringliteral">&#39; CHECK: Monthly deviations of climatology &#39;</span>,     &amp;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;     &amp;                <span class="stringliteral">&#39;to be superimposed on global annual mean&#39;</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;              print *, <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          <span class="keywordflow">elseif</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            co2ann(:,:) = 0.0</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;              <span class="keyword">read</span> (nico2cn,cform) co2dat</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">!check        print cform, co2dat</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;              <span class="keywordflow">do</span> j = 1, <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                  co2ann(i,j) = co2ann(i,j) + co2dat(i,j)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">do</span> j = 1, <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;              <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                co2ann(i,j) = co2ann(i,j) * 1.0e-6 / float(12)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;              <span class="keywordflow">do</span> j = 1, <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                  <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(i,j,imo) = co2ann(i,j)+<a class="code" href="namespacemodule__radiation__gases.html#a3985e306e5555089909fd42a4cc93afb">co2cyc_sav</a>(i,j,imo)</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordflow">if</span> ( me==0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;              print *,<span class="stringliteral">&#39; CHECK: Sample of 2-d annual mean of CO2 &#39;</span>,      &amp;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;     &amp;                <span class="stringliteral">&#39;data used for year:&#39;</span>,iyear</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;              print *, co2ann(1,:)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;              print *,<span class="stringliteral">&#39; CHECK: AFTER adding seasonal cycle, Sample &#39;</span>,   &amp;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;     &amp;                <span class="stringliteral">&#39;of selected months of CO2 data for year:&#39;</span>,iyear</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;              <span class="keywordflow">do</span> imo = 1, 12, 3</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                print *,<span class="stringliteral">&#39;        Month =&#39;</span>,imo</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                print *, <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(1,:,imo)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordflow">          endif</span>   <span class="comment">! endif_icl2flg_block</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">else</span>                  <span class="comment">! no need to calc ic time annual mean first</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 2 ) <span class="keywordflow">then</span>      <span class="comment">! directly save monthly data</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;              <span class="keyword">read</span> (nico2cn,cform) co2dat</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">!check        print cform, co2dat</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;              <span class="keywordflow">do</span> j = 1, <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                  <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(i,j,imo) = (co2dat(i,j) + rate) * 1.0e-6</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="keywordflow">if</span> ( me == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;              print *,<span class="stringliteral">&#39; CHECK: Sample of selected months of CO2 &#39;</span>,      &amp;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;     &amp;                <span class="stringliteral">&#39;data used for year:&#39;</span>,iyear</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;              <span class="keywordflow">do</span> imo = 1, 12, 3</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                print *,<span class="stringliteral">&#39;        Month =&#39;</span>,imo</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                print *, <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(1,:,imo)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keywordflow">          endif</span>   <span class="comment">! endif_ico2flg_block</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          <span class="keywordflow">do</span> imo = 1, 12</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(imo) = 0.0</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="keywordflow">        endif</span>   <span class="comment">! endif_ictmflg_block</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keyword">close</span> ( nico2cn )</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="keywordflow">      endif</span>  lab_if_idyr</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">!...................................</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemodule__radiation__gases.html#a064db1c287e8614ae7efd6b4fac91a6b">gas_update</a></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">!-----------------------------------</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">!-----------------------------------</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemodule__radiation__gases.html#ad06401a54d361b3dd852d815d1b0f71e">getgases</a>                                               &amp;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">!...................................</span></div><div class="line"><a name="l00933"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#ad06401a54d361b3dd852d815d1b0f71e">  933</a></span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;     &amp;     ( plvl, xlon, xlat,                                          &amp;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;     &amp;       imax, lmax,                                                &amp;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">!  ---  outputs:</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;     &amp;       gasdat                                                     &amp;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;     &amp;      )</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">!  ===================================================================  !</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">!  getgases set up global distribution of radiation absorbing  gases    !</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">!  in volume mixing ratio.  currently only co2 has the options from     !</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">!  observed values, all other gases are asigned to the climatological   !</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">!  values.                                                              !</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">!  inputs:                                                              !</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">!     plvl(IMAX,LMAX+1)- pressure at model layer interfaces (mb)        !</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">!     xlon(IMAX)       - grid longitude in radians, ok both 0-&gt;2pi or   !</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">!                        -pi -&gt; +pi arrangements                        !</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">!     xlat(IMAX)       - grid latitude in radians, default range to     !</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">!                        pi/2 -&gt; -pi/2, otherwise see in-line comment   !</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">!     IMAX, LMAX       - horiz, vert dimensions for output data         !</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">!  outputs:                                                             !</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">!     gasdat(IMAX,LMAX,NF_VGAS) - gases volume mixing ratioes           !</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">!               (:,:,1)           - co2                                 !</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">!               (:,:,2)           - n2o                                 !</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">!               (:,:,3)           - ch4                                 !</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">!               (:,:,4)           - o2                                  !</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">!               (:,:,5)           - co                                  !</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">!               (:,:,6)           - cfc11                               !</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">!               (:,:,7)           - cfc12                               !</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">!               (:,:,8)           - cfc22                               !</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">!               (:,:,9)           - ccl4                                !</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">!               (:,:,10)          - cfc113                              !</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">!  external module variables:  (in physparam)                           !</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">!     ico2flg    - co2 data source control flag                         !</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">!                   =0: use prescribed co2 global mean value            !</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">!                   =1: use input global mean co2 value (co2_glb)       !</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">!                   =2: use input 2-d monthly co2 value (co2vmr_sav)    !</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">!     ivflip     - vertical profile indexing flag                       !</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">!  internal module variables used:                                      !</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">!     co2vmr_sav - saved monthly co2 concentration from sub gas_update  !</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">!     co2_glb    - saved global annual mean co2 value from  gas_update  !</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">!     gco2cyc    - saved global seasonal variation of co2 climatology   !</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">!                  in 12-month form                                     !</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">!  ** note: for lower atmos co2vmr_sav may have clim monthly deviations !</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">!           superimposed on init-cond co2 value, while co2_glb only     !</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">!           contains the global mean value, thus needs to add the       !</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">!           monthly dglobal mean deviation gco2cyc at upper atmos. for  !</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">!           ictmflg/=-2, this value will be zero.                       !</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">!  usage:    call getgases                                              !</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">!  subprograms called:  none                                            !</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">!  ===================================================================  !</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">!  ---  input:</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordtype">integer</span>,  <span class="keywordtype">intent(in)</span>  :: IMAX, LMAX</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">intent(in)</span> :: plvl(:,:), xlon(:), xlat(:)</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">!  ---  output:</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">intent(out)</span> :: gasdat(:,:,:)</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">!  ---  local:</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <span class="keywordtype">integer</span> :: i, k, ilat, ilon</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: xlon1, xlat1, tmp</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">!===&gt;  ...  begin here</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">!  --- ...  assign default values</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordflow">do</span> k = 1, lmax</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keywordflow">do</span> i = 1, imax</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        gasdat(i,k,1) = <a class="code" href="namespacemodule__radiation__gases.html#a4fb5ca2e3bfaed7848d7602a22499e76">co2vmr_def</a></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        gasdat(i,k,2) = <a class="code" href="namespacemodule__radiation__gases.html#a858ad802efe755f8b4b5bde85996b6ae">n2ovmr_def</a></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        gasdat(i,k,3) = <a class="code" href="namespacemodule__radiation__gases.html#aad928d9e0064905a0b6e1eb8bb59bd23">ch4vmr_def</a></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        gasdat(i,k,4) = <a class="code" href="namespacemodule__radiation__gases.html#a910898e96b8afe92ebc82ce62ba682d8">o2vmr_def</a></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        gasdat(i,k,5) = <a class="code" href="namespacemodule__radiation__gases.html#a3554bdf03f8222d425bb6c946244cbb5">covmr_def</a></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        gasdat(i,k,6) = <a class="code" href="namespacemodule__radiation__gases.html#a23ae6bb6860bfefef0c281b7106f521e">f11vmr_def</a></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        gasdat(i,k,7) = <a class="code" href="namespacemodule__radiation__gases.html#a96d4f78070f30010626e0824b3421250">f12vmr_def</a></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        gasdat(i,k,8) = <a class="code" href="namespacemodule__radiation__gases.html#afd0018e96811ac64ef2abd8cab821eb5">f22vmr_def</a></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        gasdat(i,k,9) = <a class="code" href="namespacemodule__radiation__gases.html#a013f8faaee6df0c7c032e1786770c110">cl4vmr_def</a></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        gasdat(i,k,10)= <a class="code" href="namespacemodule__radiation__gases.html#a76ec88dc6284c48cfaae6cd05428b6dd">f113vmr_def</a></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">!  --- ...  co2 section</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">!  ---  use obs co2 global annual mean value only</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="keywordflow">do</span> k = 1, lmax</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;          <span class="keywordflow">do</span> i = 1, imax</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            gasdat(i,k,1) = <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a> + <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(<a class="code" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">kmonsav</a>)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">elseif</span> ( <a class="code" href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">ico2flg</a> == 2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">!  ---  use obs co2 monthly data with 2-d variation at lower atmos</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">!       otherwise use global mean value</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        tmp = <a class="code" href="namespacemodule__radiation__gases.html#aa5873ae54e950001ff873771378e7a1e">raddeg</a> / <a class="code" href="namespacemodule__radiation__gases.html#afda5c1d1129d865b9772e0f58dea7598">resco2</a></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keywordflow">do</span> i = 1, imax</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;          xlon1 = xlon(i)</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          <span class="keywordflow">if</span> ( xlon1 &lt; 0.0 ) xlon1 = xlon1 + <a class="code" href="namespacephyscons.html#aeb280391512de20933b4af3593a8ba38">con_pi</a>  <span class="comment">! if xlon in -pi-&gt;pi, convert to 0-&gt;2pi</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;          xlat1 = <a class="code" href="namespacemodule__radiation__gases.html#ab99c75954c59ed92a52de94ca6113f73">hfpi</a> - xlat(i)                     <span class="comment">! if xlat in pi/2 -&gt; -pi/2 range</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">!note     xlat1 = xlat(i)                            ! if xlat in 0 -&gt; pi range</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          ilon = min( <a class="code" href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">imxco2</a>, int( xlon1*tmp + 1 ))</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;          ilat = min( <a class="code" href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">jmxco2</a>, int( xlat1*tmp + 1 ))</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="namespacephysparam.html#a7318a941744b1ec62dc9a6ff5bfbb50d">ivflip</a> == 0 ) <span class="keywordflow">then</span>         <span class="comment">! index from toa to sfc</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordflow">do</span> k = 1, lmax</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;              <span class="keywordflow">if</span> ( plvl(i,k) &gt;= <a class="code" href="namespacemodule__radiation__gases.html#ab09dc05b8a02e9a0b56991508b599708">prsco2</a> ) <span class="keywordflow">then</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                gasdat(i,k,1) = <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(ilon,ilat,<a class="code" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">kmonsav</a>)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                gasdat(i,k,1) = <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a> + <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(<a class="code" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">kmonsav</a>)</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          <span class="keywordflow">else</span>                            <span class="comment">! index from sfc to toa</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            <span class="keywordflow">do</span> k = 1, lmax</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;              <span class="keywordflow">if</span> ( plvl(i,k+1) &gt;= <a class="code" href="namespacemodule__radiation__gases.html#ab09dc05b8a02e9a0b56991508b599708">prsco2</a> ) <span class="keywordflow">then</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                gasdat(i,k,1) = <a class="code" href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">co2vmr_sav</a>(ilon,ilat,<a class="code" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">kmonsav</a>)</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                gasdat(i,k,1) = <a class="code" href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">co2_glb</a> + <a class="code" href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">gco2cyc</a>(<a class="code" href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">kmonsav</a>)</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">!...................................</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemodule__radiation__gases.html#ad06401a54d361b3dd852d815d1b0f71e">getgases</a></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">!-----------------------------------</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">!-----------------------------------</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemodule__radiation__gases.html#af4be311f1ec1601a167655c1632d66de">getozn</a>                                                 &amp;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">!...................................</span></div><div class="line"><a name="l01086"></a><span class="lineno"><a class="line" href="namespacemodule__radiation__gases.html#af4be311f1ec1601a167655c1632d66de"> 1086</a></span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;     &amp;     ( prslk,xlat,                                                &amp;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;     &amp;       imax, lm,                                                  &amp;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">!  ---  outputs:</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;     &amp;       o3mmr                                                      &amp;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;     &amp;     )</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">!  ===================================================================  !</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">!  getozn sets up climatological ozone profile for radiation calculation!</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">!  this code is originally written By Shrinivas Moorthi                 !</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">!  inputs:                                                              !</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">!     prslk (IMAX,LM)  - exner function = (p/p0)**rocp                  !</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">!     xlat  (IMAX)     - latitude in radians, default to pi/2 -&gt; -pi/2  !</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">!                        range, otherwise see in-line comment           !</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">!     IMAX, LM         - horizontal and vertical dimensions             !</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">!  outputs:                                                             !</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">!     o3mmr (IMAX,LM)  - output ozone profile in mass mixing ratio (g/g)!</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">!  module variables:                                                    !</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">!     k1oz, k2oz       - ozone data interpolation indices               !</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">!     facoz            - ozone data interpolation factor                !</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">!     ivflip           - control flag for direction of vertical index   !</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">!  usage:    call getozn                                                !</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">!                                                                       !</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">!  ===================================================================  !</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordtype">integer</span>,  <span class="keywordtype">intent(in)</span> :: IMAX, LM</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">intent(in)</span> :: prslk(:,:), xlat(:)</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">!  ---  outputs:</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">intent(out)</span> :: o3mmr(:,:)</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">!  ---  locals:</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: o3i(imax,loz), wk1(imax), deglat, elte,  &amp;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;     &amp;                         tem, tem1, tem2, tem3, tem4, temp</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                                                                               </div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordtype">integer</span> :: i, j, k, l, j1, j2, ll</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">!===&gt; ...  begin here</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      elte = blte + (jmr-1)*dlte</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="keywordflow">do</span> i = 1, imax</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        deglat = xlat(i) * <a class="code" href="namespacemodule__radiation__gases.html#aa5873ae54e950001ff873771378e7a1e">raddeg</a>        <span class="comment">! if xlat in pi/2 -&gt; -pi/2 range</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">!       deglat = 90.0 - xlat(i)*raddeg   ! if xlat in 0 -&gt; pi range</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">if</span> (deglat &gt; blte .and. deglat &lt; elte) <span class="keywordflow">then</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          tem1 = (deglat - blte) / dlte + 1</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;          j1   = tem1</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;          j2   = j1 + 1</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          tem1 = tem1 - j1</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="keywordflow">elseif</span> (deglat &lt;= blte) <span class="keywordflow">then</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          j1   = 1</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          j2   = 1</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;          tem1 = 1.0</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="keywordflow">elseif</span> (deglat &gt;= elte) <span class="keywordflow">then</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;          j1   = jmr</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;          j2   = jmr</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          tem1 = 1.0</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        tem2 = 1.0 - tem1</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">do</span> j = 1, loz</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          tem3     = tem2*<a class="code" href="namespacemodule__radiation__gases.html#ad18392d991a9ef4b6ff0e8e822176a18">o3r</a>(j1,j,<a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a>) + tem1*<a class="code" href="namespacemodule__radiation__gases.html#ad18392d991a9ef4b6ff0e8e822176a18">o3r</a>(j2,j,<a class="code" href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">k1oz</a>)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          tem4     = tem2*<a class="code" href="namespacemodule__radiation__gases.html#ad18392d991a9ef4b6ff0e8e822176a18">o3r</a>(j1,j,<a class="code" href="namespacemodule__radiation__gases.html#a0c3727c9e2a0bec46e84622c4591cd8b">k2oz</a>) + tem1*<a class="code" href="namespacemodule__radiation__gases.html#ad18392d991a9ef4b6ff0e8e822176a18">o3r</a>(j2,j,<a class="code" href="namespacemodule__radiation__gases.html#a0c3727c9e2a0bec46e84622c4591cd8b">k2oz</a>)</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;          o3i(i,j) = tem4*<a class="code" href="namespacemodule__radiation__gases.html#ac7c9fd8ece69872fdef473020ea03d6b">facoz</a>          + tem3*(1.0 - <a class="code" href="namespacemodule__radiation__gases.html#ac7c9fd8ece69872fdef473020ea03d6b">facoz</a>)</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">do</span> l = 1, lm</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        ll = l</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacephysparam.html#a7318a941744b1ec62dc9a6ff5bfbb50d">ivflip</a> == 1) ll = lm -l + 1</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <span class="keywordflow">do</span> i = 1, imax</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;          wk1(i) = prslk(i,ll)</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="keywordflow">do</span> k = 1, loz-1</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          temp = 1.0 / (<a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(k+1) - <a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(k))</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          <span class="keywordflow">do</span> i = 1, imax</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <span class="keywordflow">if</span> (wk1(i) &gt; <a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(k) .and. wk1(i) &lt;= <a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(k+1)) <span class="keywordflow">then</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;              tem       = (<a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(k+1) - wk1(i)) * temp</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;              o3mmr(i,ll) = tem * o3i(i,k) + (1.0 - tem) * o3i(i,k+1)</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="keywordflow">do</span> i = 1, imax</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          <span class="keywordflow">if</span> (wk1(i) &gt; <a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(loz)) o3mmr(i,ll) = o3i(i,loz)</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;          <span class="keywordflow">if</span> (wk1(i) &lt; <a class="code" href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">pkstr</a>(1))   o3mmr(i,ll) = o3i(i,1)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">!...................................</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemodule__radiation__gases.html#af4be311f1ec1601a167655c1632d66de">getozn</a></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">!-----------------------------------</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">!........................................!</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keyword">      end module </span><a class="code" href="namespacemodule__radiation__gases.html">module_radiation_gases</a>  <span class="comment">!</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">!========================================!</span></div><div class="ttc" id="namespacemodule__radiation__gases_html_ac7466def3963591ebfc48298806b1f6a"><div class="ttname"><a href="namespacemodule__radiation__gases.html#ac7466def3963591ebfc48298806b1f6a">module_radiation_gases::pkstr</a></div><div class="ttdeci">real(kind=kind_phys), dimension(:), allocatable pkstr</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00168">radiation_gases.f:168</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_aad928d9e0064905a0b6e1eb8bb59bd23"><div class="ttname"><a href="namespacemodule__radiation__gases.html#aad928d9e0064905a0b6e1eb8bb59bd23">module_radiation_gases::ch4vmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter ch4vmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00148">radiation_gases.f:148</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a858ad802efe755f8b4b5bde85996b6ae"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a858ad802efe755f8b4b5bde85996b6ae">module_radiation_gases::n2ovmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter n2ovmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00147">radiation_gases.f:147</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a1def261c0ef5d5408658c87b6dc08b53"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a1def261c0ef5d5408658c87b6dc08b53">module_radiation_gases::gas_init</a></div><div class="ttdeci">subroutine, public gas_init                                                                                          </div><div class="ttdoc">This subroutine sets up ozone, co2, etc. parameters. if climatology ozone then read in monthly ozone ...</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00217">radiation_gases.f:217</a></div></div>
<div class="ttc" id="namespacephysparam_html_a90d63a1a0c04479f586ce21df72d36b7"><div class="ttname"><a href="namespacephysparam.html#a90d63a1a0c04479f586ce21df72d36b7">physparam::ioznflg</a></div><div class="ttdeci">integer, save ioznflg</div><div class="ttdoc">ozone dta source control flag </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00175">physparam.f:175</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a4fb5ca2e3bfaed7848d7602a22499e76"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a4fb5ca2e3bfaed7848d7602a22499e76">module_radiation_gases::co2vmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter co2vmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00146">radiation_gases.f:146</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a910898e96b8afe92ebc82ce62ba682d8"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a910898e96b8afe92ebc82ce62ba682d8">module_radiation_gases::o2vmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter o2vmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00149">radiation_gases.f:149</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a46eb4079ff9932819b3ab133bf6a43d9"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a46eb4079ff9932819b3ab133bf6a43d9">module_radiation_gases::imxco2</a></div><div class="ttdeci">integer, parameter imxco2</div><div class="ttdoc">input co2 dat lon points </div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00133">radiation_gases.f:133</a></div></div>
<div class="ttc" id="namespacephysparam_html_a2af9769060fccf9c42e14a30cf21c0aa"><div class="ttname"><a href="namespacephysparam.html#a2af9769060fccf9c42e14a30cf21c0aa">physparam::co2usr_file</a></div><div class="ttdeci">character, save co2usr_file</div><div class="ttdoc">external co2 user defined data table </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00181">physparam.f:181</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_affc350828412da77ff3cf3e617ddc66c"><div class="ttname"><a href="namespacemodule__radiation__gases.html#affc350828412da77ff3cf3e617ddc66c">module_radiation_gases::nf_vgas</a></div><div class="ttdeci">integer, parameter, public nf_vgas</div><div class="ttdoc">number of gas species </div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00131">radiation_gases.f:131</a></div></div>
<div class="ttc" id="namespacephysparam_html_ad3e0f053cd067945bdc816b1a81a859a"><div class="ttname"><a href="namespacephysparam.html#ad3e0f053cd067945bdc816b1a81a859a">physparam::co2gbl_file</a></div><div class="ttdeci">character, save co2gbl_file</div><div class="ttdoc">external co2 global annual mean data table </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00179">physparam.f:179</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_ab99c75954c59ed92a52de94ca6113f73"><div class="ttname"><a href="namespacemodule__radiation__gases.html#ab99c75954c59ed92a52de94ca6113f73">module_radiation_gases::hfpi</a></div><div class="ttdeci">real(kind=kind_phys), parameter hfpi</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00143">radiation_gases.f:143</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_aa5873ae54e950001ff873771378e7a1e"><div class="ttname"><a href="namespacemodule__radiation__gases.html#aa5873ae54e950001ff873771378e7a1e">module_radiation_gases::raddeg</a></div><div class="ttdeci">real(kind=kind_phys), parameter raddeg</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00141">radiation_gases.f:141</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a064db1c287e8614ae7efd6b4fac91a6b"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a064db1c287e8614ae7efd6b4fac91a6b">module_radiation_gases::gas_update</a></div><div class="ttdeci">subroutine, public gas_update                                                                                      </div><div class="ttdoc">This subroutine reads in 2-d monthly co2 data set for a specified year. data are in a 15 degree lat/l...</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00535">radiation_gases.f:535</a></div></div>
<div class="ttc" id="namespacephyscons_html"><div class="ttname"><a href="namespacephyscons.html">physcons</a></div><div class="ttdoc">This module contains some the most frequently used math and physics constants for gcm models...</div><div class="ttdef"><b>Definition:</b> <a href="physcons_8f_source.html#l00029">physcons.f:29</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a96d4f78070f30010626e0824b3421250"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a96d4f78070f30010626e0824b3421250">module_radiation_gases::f12vmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter f12vmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00152">radiation_gases.f:152</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a8a79a6d3d931da021cd19290c58bdfaa"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a8a79a6d3d931da021cd19290c58bdfaa">module_radiation_gases::vtaggas</a></div><div class="ttdeci">character(40), parameter vtaggas</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00125">radiation_gases.f:125</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_ad06401a54d361b3dd852d815d1b0f71e"><div class="ttname"><a href="namespacemodule__radiation__gases.html#ad06401a54d361b3dd852d815d1b0f71e">module_radiation_gases::getgases</a></div><div class="ttdeci">subroutine, public getgases                                                                                          </div><div class="ttdoc">This subroutine sets up global distribution of radiation absorbing gases in volume mixing ratio...</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00933">radiation_gases.f:933</a></div></div>
<div class="ttc" id="namespacephysparam_html"><div class="ttname"><a href="namespacephysparam.html">physparam</a></div><div class="ttdoc">This module defines commonly used control variables/parameters in physics related programs...</div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00027">physparam.f:27</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a0c3727c9e2a0bec46e84622c4591cd8b"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a0c3727c9e2a0bec46e84622c4591cd8b">module_radiation_gases::k2oz</a></div><div class="ttdeci">integer k2oz</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00169">radiation_gases.f:169</a></div></div>
<div class="ttc" id="namespacephysparam_html_a61baf693e83ac6144d86fb8213d39a79"><div class="ttname"><a href="namespacephysparam.html#a61baf693e83ac6144d86fb8213d39a79">physparam::ico2flg</a></div><div class="ttdeci">integer, save ico2flg</div><div class="ttdoc">co2 data source control flag </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00171">physparam.f:171</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_ac2a03ad96c9aa598f9751fd689cb615f"><div class="ttname"><a href="namespacemodule__radiation__gases.html#ac2a03ad96c9aa598f9751fd689cb615f">module_radiation_gases::gco2cyc</a></div><div class="ttdeci">real(kind=kind_phys), dimension(12) gco2cyc</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00177">radiation_gases.f:177</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_ad18392d991a9ef4b6ff0e8e822176a18"><div class="ttname"><a href="namespacemodule__radiation__gases.html#ad18392d991a9ef4b6ff0e8e822176a18">module_radiation_gases::o3r</a></div><div class="ttdeci">real(kind=kind_phys), dimension(:,:,:), allocatable o3r</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00168">radiation_gases.f:168</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a0a14666484f230d3506a9b4740e2eeda"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a0a14666484f230d3506a9b4740e2eeda">module_radiation_gases::k1oz</a></div><div class="ttdeci">integer k1oz</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00169">radiation_gases.f:169</a></div></div>
<div class="ttc" id="namespacephysparam_html_abed249e396bbc5c096408db58b5104c0"><div class="ttname"><a href="namespacephysparam.html#abed249e396bbc5c096408db58b5104c0">physparam::co2dat_file</a></div><div class="ttdeci">character, save co2dat_file</div><div class="ttdoc">external co2 2d monthly obsv data table </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00177">physparam.f:177</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a6b4372e633bef3fb367e6ff3cf200bb8"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a6b4372e633bef3fb367e6ff3cf200bb8">module_radiation_gases::kyrsav</a></div><div class="ttdeci">integer kyrsav</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00180">radiation_gases.f:180</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a76ec88dc6284c48cfaae6cd05428b6dd"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a76ec88dc6284c48cfaae6cd05428b6dd">module_radiation_gases::f113vmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter f113vmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00155">radiation_gases.f:155</a></div></div>
<div class="ttc" id="namespacephysparam_html_a7318a941744b1ec62dc9a6ff5bfbb50d"><div class="ttname"><a href="namespacephysparam.html#a7318a941744b1ec62dc9a6ff5bfbb50d">physparam::ivflip</a></div><div class="ttdeci">integer, save ivflip</div><div class="ttdoc">vertical profile indexing flag </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00224">physparam.f:224</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_ab1cf1b63398a3e7ec0334a7c97258b4d"><div class="ttname"><a href="namespacemodule__radiation__gases.html#ab1cf1b63398a3e7ec0334a7c97258b4d">module_radiation_gases::kmonsav</a></div><div class="ttdeci">integer kmonsav</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00181">radiation_gases.f:181</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a0398d6837c9e8c41359e76a754147002"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a0398d6837c9e8c41359e76a754147002">module_radiation_gases::co2_glb</a></div><div class="ttdeci">real(kind=kind_phys) co2_glb</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00176">radiation_gases.f:176</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a3554bdf03f8222d425bb6c946244cbb5"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a3554bdf03f8222d425bb6c946244cbb5">module_radiation_gases::covmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter covmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00150">radiation_gases.f:150</a></div></div>
<div class="ttc" id="namespacephysparam_html_afe0dc3a936d79b4d7dd58fe29376cb1a"><div class="ttname"><a href="namespacephysparam.html#afe0dc3a936d79b4d7dd58fe29376cb1a">physparam::co2cyc_file</a></div><div class="ttdeci">character, save co2cyc_file</div><div class="ttdoc">external co2 clim monthly cycle data table </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00183">physparam.f:183</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a4f35e5db780a64963dc65b8449def39d"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a4f35e5db780a64963dc65b8449def39d">module_radiation_gases::co2vmr_sav</a></div><div class="ttdeci">real(kind=kind_phys), dimension(:,:,:), allocatable co2vmr_sav</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00173">radiation_gases.f:173</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_aa56e209872093bfcbdaeb452f5e5e332"><div class="ttname"><a href="namespacemodule__radiation__gases.html#aa56e209872093bfcbdaeb452f5e5e332">module_radiation_gases::jmxco2</a></div><div class="ttdeci">integer, parameter jmxco2</div><div class="ttdoc">input co2 data lat points </div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00135">radiation_gases.f:135</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_afda5c1d1129d865b9772e0f58dea7598"><div class="ttname"><a href="namespacemodule__radiation__gases.html#afda5c1d1129d865b9772e0f58dea7598">module_radiation_gases::resco2</a></div><div class="ttdeci">real(kind=kind_phys), parameter resco2</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00140">radiation_gases.f:140</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_ab09dc05b8a02e9a0b56991508b599708"><div class="ttname"><a href="namespacemodule__radiation__gases.html#ab09dc05b8a02e9a0b56991508b599708">module_radiation_gases::prsco2</a></div><div class="ttdeci">real(kind=kind_phys), parameter prsco2</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00142">radiation_gases.f:142</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a3985e306e5555089909fd42a4cc93afb"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a3985e306e5555089909fd42a4cc93afb">module_radiation_gases::co2cyc_sav</a></div><div class="ttdeci">real(kind=kind_phys), dimension(:,:,:), allocatable co2cyc_sav</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00174">radiation_gases.f:174</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a3b26af64187b57999cadeced419b0f1b"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a3b26af64187b57999cadeced419b0f1b">module_radiation_gases::minyear</a></div><div class="ttdeci">integer, parameter minyear</div><div class="ttdoc">earlist year 2-d co2 data available </div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00137">radiation_gases.f:137</a></div></div>
<div class="ttc" id="namespacephyscons_html_aeb280391512de20933b4af3593a8ba38"><div class="ttname"><a href="namespacephyscons.html#aeb280391512de20933b4af3593a8ba38">physcons::con_pi</a></div><div class="ttdeci">real(kind=kind_phys), parameter con_pi</div><div class="ttdef"><b>Definition:</b> <a href="physcons_8f_source.html#l00041">physcons.f:41</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a23ae6bb6860bfefef0c281b7106f521e"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a23ae6bb6860bfefef0c281b7106f521e">module_radiation_gases::f11vmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter f11vmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00151">radiation_gases.f:151</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_af4be311f1ec1601a167655c1632d66de"><div class="ttname"><a href="namespacemodule__radiation__gases.html#af4be311f1ec1601a167655c1632d66de">module_radiation_gases::getozn</a></div><div class="ttdeci">subroutine, public getozn                                                                                              </div><div class="ttdoc">This subroutine sets up climatological ozone profile for radiation calculation this code is originall...</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l01086">radiation_gases.f:1086</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html"><div class="ttname"><a href="namespacemodule__radiation__gases.html">module_radiation_gases</a></div><div class="ttdoc">This module sets up ozone climatological profiles and other constant gas profiles, such as co2, ch4, n2o, o2, and those of cfc gases. All data are entered as mixing ratio by volume, except ozone which is mass mixing ratio (g/g). </div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00106">radiation_gases.f:106</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_afd0018e96811ac64ef2abd8cab821eb5"><div class="ttname"><a href="namespacemodule__radiation__gases.html#afd0018e96811ac64ef2abd8cab821eb5">module_radiation_gases::f22vmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter f22vmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00153">radiation_gases.f:153</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_ac7c9fd8ece69872fdef473020ea03d6b"><div class="ttname"><a href="namespacemodule__radiation__gases.html#ac7c9fd8ece69872fdef473020ea03d6b">module_radiation_gases::facoz</a></div><div class="ttdeci">real(kind=kind_phys) facoz</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00170">radiation_gases.f:170</a></div></div>
<div class="ttc" id="namespacephysparam_html_a4eef5ac5e5b83526d5da7de493cfe73d"><div class="ttname"><a href="namespacephysparam.html#a4eef5ac5e5b83526d5da7de493cfe73d">physparam::ictmflg</a></div><div class="ttdeci">integer, save ictmflg</div><div class="ttdoc">external data time/date control flag </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00173">physparam.f:173</a></div></div>
<div class="ttc" id="namespacemodule__radiation__gases_html_a013f8faaee6df0c7c032e1786770c110"><div class="ttname"><a href="namespacemodule__radiation__gases.html#a013f8faaee6df0c7c032e1786770c110">module_radiation_gases::cl4vmr_def</a></div><div class="ttdeci">real(kind=kind_phys), parameter cl4vmr_def</div><div class="ttdef"><b>Definition:</b> <a href="radiation__gases_8f_source.html#l00154">radiation_gases.f:154</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="radiation__gases_8f.html">radiation_gases.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
