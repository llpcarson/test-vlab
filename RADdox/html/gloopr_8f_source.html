<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Radiation Scheme in CCPP: working_src/gloopr.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Radiation Scheme in CCPP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('gloopr_8f_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">gloopr.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="gloopr_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!! \todo gloopr param and arguments</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!! \param[] grid_fld</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="gloopr_8f.html#aa4598a23017d824c298984f4b1f14555">gloopr</a> (grid_fld, g3d_fld, aoi_fld,                   &amp;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;     &amp;                    lats_nodes_r,global_lats_r, lonsperlar, phour,&amp;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;     &amp;                    deltim,xlon,xlat,coszdg,coszen,slmsk,snwdph,  &amp;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;     &amp;                    sncovr,snoalb,zorl,tsea,hprime,sfalb,         &amp;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;     &amp;                    alvsf,alnsf ,alvwf ,alnwf,facsf ,facwf,cv,cvt,&amp;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;     &amp;                    cvb  ,swh,swhc,hlw,hlwc,sfcnsw,sfcdlw,        &amp;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;     &amp;                    fice ,tisfc, sfcdsw, sfcemis,                 &amp;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;     &amp;                    tsflw,fluxr, phy_f3d,phy_f2d,                 &amp;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;     &amp;                    slag,sdec,cdec,nblck,kdt                      &amp;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!    &amp;,    htrswb,htrlwb                                                &amp;</span></div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="gloopr_8f.html#aa4598a23017d824c298984f4b1f14555">   20</a></span>&#160;     &amp;    )</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!    &amp;     global_times_r)</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!! Code Revision:</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!! Oct 11 2009       Sarah Lu, grid_gr is replaced by grid_fld</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!! Oct 16 2009       Sarah Lu, grid_fld%tracers used</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">!! Dec 01 2009       Sarah Lu, update fcld (instant cloud cover) in addition</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">!!                             to cldcov (cumulative cloud cover)</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">!! Dec 09 2009       Sarah Lu, (1) g3d_fld added to calling argument; (2) grrad</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">!!                   returns instant cloud cover (cldcov_v); the accumulative </span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">!!                   and instant cloud cover fields are updated after grrad call</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">!! Dec 11 2009       Sarah Lu, ldiag3d removed from grrad calling argument</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">!! Jul/Aug 2009      S. Moorthi Merged with McICA version of radiation from YuTai</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">!  apr 2012  - y-t hou     -  modified radiation calling interval</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">!             parameters fhswr/fhlwr.  changed units from hour to second</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">!             (in multiple of model time step length), thus radiation</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">!             can</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!             be invoked more frequently than the minimum of 1 hr limit.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">!                              -  moved radiation initialization part to</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">!             the beginning of model initialization process. in the time</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">!             loop, added a subroutine &quot;radupdate&quot; to updae radiation</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">!             related</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">!             external data sets (such as aerosols, gases, astronomy,</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">!             etc.)</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">!             moved computation of coszen to inside subrouine &quot;grrad&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">!  nov 2012  - y-t hou     - modified many physics/radiation control</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">!             parameters through module &#39;physparam&#39; which contains the</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">!             use of</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">!             module &#39;machine&#39;.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">!! Nov 20 2012       Jun Wang  fix the vertical index from levs to levr for gt,gr..etc</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!  may 2013 s. mooorthi - removed fpkapx</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">!  oct 2013 henry Juang  compute prsi from model top with model pressure</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!                        thickness to surface for accuracy</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">!  Mar 2014 Xingren Wu - Add visbm/visdf/nirbm/nirdf to extract for A/O/I coupling</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">!  Jul 2014 S Moorthi  - merge with GFS and clean up a bit</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">!  jun 2014  - y-t hou     - revised to utilize surface up/down spectral component sw</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">!             fluxes for grid composite mean (combined land,ocean,ice,snow), also</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">!             estimate ocean values without ice contamination.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!  Aug 2015 S Moorthi - Adding sgs clouds from shoc as an option</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacephysparam.html">physparam</a></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacephyscons.html">physcons</a>, fv =&gt; <a class="code" href="namespacephyscons.html#ad200a2d8149c61dbdd05124ce977a928">con_fvirt</a>, rerth =&gt; <a class="code" href="namespacephyscons.html#a45809304b133b2581328b19b36dd47bc">con_rerth</a>,  rk =&gt; <a class="code" href="namespacephyscons.html#a72b27573c69ec418b67763d35b3688a1">con_rocp</a></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">use </span>namelist_physics_def<span class="keywordtype">,      only</span> : shoc_cld</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemodule__radiation__driver.html">module_radiation_driver</a><span class="keywordtype">,   only</span> : <a class="code" href="namespacemodule__radiation__driver.html#af039e0c23dc6ab8d2f8b1c1c796ac0da">radinit</a>, <a class="code" href="namespacemodule__radiation__driver.html#a8285cf6a4d2e1ed25b0afff8e269ec63">grrad</a>, <a class="code" href="namespacemodule__radiation__driver.html#a47f0e4defe607fbfc751f6c9274f459a">radupdate</a></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">!     use module_radiation_astronomy,only : astronomy</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordtype">USE </span>gfs_phy_tracer_config<span class="keywordtype">,     only</span> : gfs_phy_tracer</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemodule__radsw__parameters.html">module_radsw_parameters</a><span class="keywordtype">,   only</span> : <a class="code" href="namespacemodule__radsw__parameters.html#structmodule__radsw__parameters_1_1topfsw__type">topfsw_type</a>, <a class="code" href="namespacemodule__radsw__parameters.html#structmodule__radsw__parameters_1_1sfcfsw__type">sfcfsw_type</a></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemodule__radlw__parameters.html">module_radlw_parameters</a><span class="keywordtype">,   only</span> : <a class="code" href="namespacemodule__radlw__parameters.html#structmodule__radlw__parameters_1_1topflw__type">topflw_type</a>, <a class="code" href="namespacemodule__radlw__parameters.html#structmodule__radlw__parameters_1_1sfcflw__type">sfcflw_type</a></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">!! ---  for optional spectral band heating outputs</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemodule__radsw__parameters.html">module_radsw_parameters</a><span class="keywordtype">,   only</span> : <a class="code" href="namespacemodule__radsw__parameters.html#ab1e121fde29dde00871e4a7d43be1ddb">nbdsw</a></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemodule__radlw__parameters.html">module_radlw_parameters</a><span class="keywordtype">,   only</span> : <a class="code" href="namespacemodule__radlw__parameters.html#a39a115a97296886b2e6e37b220e942c7">nbdlw</a></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordtype">use </span>resol_def<span class="keywordtype">,             ONLY</span>: levs, levr, latr, lonr, lotgr,   &amp;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;     &amp;                                 g_t, g_p, g_q, g_dp, g_ps,       &amp;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;     &amp;                                 ntcw, ntoz, ncld,num_p3d,        &amp;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;     &amp;                                 nmtvr, ntrac, levp1, nfxr,g_dpdt,&amp;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;     &amp;                                 lgocart,ntot3d,ntot2d,npdf3d</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordtype">use </span>layout1<span class="keywordtype">,               ONLY</span>: me, nodes, lats_node_r,          &amp;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;     &amp;                                 lats_node_r_max, ipt_lats_node_r</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordtype">use </span>gg_def<span class="keywordtype">,                ONLY</span>: coslat_r, sinlat_r</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordtype">use </span>date_def<span class="keywordtype">,              ONLY</span>: idate</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordtype">use </span>namelist_physics_def<span class="keywordtype">,  ONLY</span>: lsswr, iaer, lslwr, sashal, ras, &amp;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;     &amp;                                 lssav, flgmin, ldiag3d,          &amp;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;     &amp;                                 iovr_lw, iovr_sw, isol, iems,    &amp;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;     &amp;                                 ialb, fhlwr, fhswr, ico2, ngptc, &amp;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;     &amp;                                 crick_proof, norad_precip,ccnorm,&amp;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;     &amp;                                 ictm, isubc_sw, isubc_lw, fdaer, &amp; </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;     &amp;                                 sup, ndfi, fhdfi, cplflx</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordtype">use </span>d3d_def <span class="keywordtype">,                ONLY</span>: cldcov</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keywordtype">use </span>gfs_physics_gridgr_mod<span class="keywordtype">,  ONLY</span>: grid_var_data</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordtype">use </span>gfs_physics_g3d_mod<span class="keywordtype">,     ONLY</span>: g3d_var_data</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordtype">use </span>gfs_physics_aoi_var_mod<span class="keywordtype">, ONLY</span>: aoi_var_data</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespacemersenne__twister.html">mersenne_twister</a><span class="keywordtype">,        only</span>: random_setseed, random_index,  &amp;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;     &amp;                                  random_stat</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">parameter</span> :: QMIN =1.0e-10                 &amp;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;     &amp;,                                   typical_pgr = 95.0            &amp;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;     &amp;,                                   cons0 = 0.0,  cons2 = 2.0     &amp;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;     &amp;,                                   pt00001=1.0e-5</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">!    &amp;,                                   pt01=0.01</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">!  --- ...  inputs:</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lats_nodes_r(nodes)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: global_lats_r(latr), lonsperlar(latr)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">!*    real(kind=kind_grid) grid_gr(lonr*lats_node_r_max,lotgr)</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordtype">TYPE</span>(grid_var_data) :: grid_fld </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordtype">TYPE</span>(g3d_var_data)  :: g3d_fld </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordtype">type</span>(aoi_var_data)  :: aoi_fld</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: NBLCK</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">dimension(LONR,LATS_NODE_R)</span>, <span class="keywordtype">intent(in)</span> :: &amp;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;     &amp;                       xlon, xlat, slmsk, snwdph, zorl, tsea,     &amp;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;     &amp;                       alvsf, alnsf, alvwf, alnwf, facsf, facwf,  &amp;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     &amp;                       cv, cvt, cvb, FICE, tisfc, sncovr, snoalb</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">intent(inout)</span> ::                           &amp;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;     &amp;    hprime(NMTVR,LONR,LATS_NODE_R), phour, deltim,                &amp;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;     &amp;    phy_f3d(NGPTC,LEVS,ntot3d,NBLCK,LATS_NODE_R),                 &amp;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;     &amp;    phy_f2d(lonr,lats_node_r,ntot2d)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">intent(inout)</span> ::                           &amp;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;     &amp;                    fluxr (NFXR,LONR,LATS_NODE_R)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: KDT</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">!  --- ...  outputs:</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">!     real(kind=kind_evod), intent(out) ::                              &amp;</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">!    &amp;                    global_times_r(latr,NODES)</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">intent(out)</span>, dimension                     &amp;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;     &amp;          (ngptc,levs,nblck,lats_node_r) :: swh, swhc, hlw, hlwc</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>,<span class="keywordtype">dimension(LONR,LATS_NODE_R)</span>, <span class="keywordtype">intent(out)</span> :: &amp;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     &amp;                    coszdg, coszen, sfcnsw, sfcdlw, tsflw,        &amp;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;     &amp;                    sfcdsw, SFALB, sfcemis</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">intent(out)</span> :: slag, sdec, cdec</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">!! --- ...  optional spectral band heating rates</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">!     real (kind=kind_phys), optional, intent(out) ::                   &amp;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">!    &amp;                 htrswb(NGPTC,LEVS,NBDSW,NBLCK,LATS_NODE_R),      &amp;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">!    &amp;                 htrlwb(NGPTC,LEVS,NBDLW,NBLCK,LATS_NODE_R)</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">!  --- ...  locals:</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">real(kind=kind_phys)</span> :: prsl(ngptc,levs),  prslk(ngptc,levs),     &amp;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     &amp;                        prsi(NGPTC,LEVP1)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">!     real (kind=kind_phys) :: si_loc(LEVR+1)</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: dswcmp(ngptc,4), uswcmp(ngptc,4),        &amp;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;     &amp;                         gt(NGPTC,LEVR),                          &amp;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;     &amp;                         gr(NGPTC,LEVR), gr1(NGPTC,LEVR,NTRAC-1)</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">dimension(ngptc,levs)</span> :: deltaq, cnvw, cnvc</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;     &amp;,            f_ice, f_rain, r_rime, hlwc_v, swhc_v, cldcov_v, vvel</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> ::  fluxr_v(ngptc,nfxr)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> ::  work1, work2</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">dimension(ngptc)</span> :: coszen_v, coszdg_v,    &amp;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;     &amp;             sinlat_v, coslat_v, hprime_v, flgmin_v</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">!     real (kind=kind_phys), dimension(LONR,LATS_NODE_R) ::             &amp;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">!    &amp;                         sinlat_v, coslat_v</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: rinc(5), dtsw, dtlw, solcon, raddt, solhr</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordtype">real (kind=4)</span>         :: rinc4(5)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordtype">integer</span> w3kindreal,w3kindint</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span>, <span class="keywordtype">save</span> :: facoz</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">integer</span> :: njeff, lon, lan, lat, iblk, lons_lat, kk</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordtype">integer</span> :: idat(8), jdat(8), DAYS(13), iday, imon, midmon, id</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordtype">integer</span> :: nlnsp(lats_node_r)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">!  ---  variables of instantaneous calculated toa/sfc radiation fluxes</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      type(<a class="code" href="namespacemodule__radsw__parameters.html#structmodule__radsw__parameters_1_1topfsw__type">topfsw_type</a>), <span class="keywordtype">dimension(NGPTC)</span> :: topfsw</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      type(<a class="code" href="namespacemodule__radsw__parameters.html#structmodule__radsw__parameters_1_1sfcfsw__type">sfcfsw_type</a>), <span class="keywordtype">dimension(NGPTC)</span> :: sfcfsw</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      type(<a class="code" href="namespacemodule__radlw__parameters.html#structmodule__radlw__parameters_1_1topflw__type">topflw_type</a>), <span class="keywordtype">dimension(NGPTC)</span> :: topflw</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      type(<a class="code" href="namespacemodule__radlw__parameters.html#structmodule__radlw__parameters_1_1sfcflw__type">sfcflw_type</a>), <span class="keywordtype">dimension(NGPTC)</span> :: sfcflw</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">!  ---  variables used for random number generator (thread safe mode)</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      type(random_stat) :: stat</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordtype">integer</span> :: numrdm(lonr*latr*2), ixseed(lonr,lats_node_r,2)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordtype">integer</span> :: ipseed, icsdlw(ngptc), icsdsw(ngptc)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: ipsdlim = 1.0e8      <span class="comment">! upper limit for random seeds</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">!     integer, save :: icwp, k1oz, k2oz, midm, midp, ipsd0, iaerflg</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">!  ---  number of days in a month</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">!     data DAYS / 31,28,31,30,31,30,31,31,30,31,30,31,30 /</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">!  --- ...  control parameters: </span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">!           (some of the them may be moved into model namelist)</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">!  ---  ICTM=yyyy#, controls time sensitive external data (e.g. CO2, solcon, aerosols, etc)</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">!     integer, parameter :: ICTM =   -2 ! same as ICTM=0, but add seasonal cycle</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">!                                       ! from climatology. no extrapolation.</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">!     integer, parameter :: ICTM =   -1 ! use user provided external data set for the</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">!                                       ! forecast time. no extrapolation.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">!     integer, parameter :: ICTM =    0 ! use data at initial cond time, if not</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">!                                       ! available, use latest, no extrapolatio n.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">!!    integer, parameter :: ICTM =    1 ! use data at the forecast time, if not</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">!                                       ! available, use latest and extrapolation.</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">!     integer, parameter :: ICTM =yyyy0 ! use yyyy data for the forecast time,</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">!                                       ! no further data extrapolation.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">!     integer, parameter :: ICTM =yyyy1 ! use yyyy data for the fcst. if needed, do</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">!                                       ! extrapolation to match the fcst time.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">!  ---  ISOL controls solar constant data source</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">!!    integer, parameter :: ISOL  = 0  ! use prescribed solar constant</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">!     integer, parameter :: ISOL  = 1  ! use varying solar const with 11-yr cycle</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">!  ---  ICO2 controls co2 data source for radiation</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">!     integer, parameter :: ICO2 = 0   ! prescribed global mean value (old opernl)</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">!!    integer, parameter :: ICO2 = 1   ! use obs co2 annual mean value only</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">!     integer, parameter :: ICO2 = 2   ! use obs co2 monthly data with 2-d variation</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">!  ---  IALB controls surface albedo for sw radiation</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">!!    integer, parameter :: IALB = 0   ! use climatology alb, based on sfc type</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">!     integer, parameter :: IALB = 1   ! use modis derived alb (to be developed)</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">!  ---  IEMS controls surface emissivity and sfc air/ground temp for lw radiation</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">!        ab: 2-digit control flags. a-for sfc temperature;  b-for emissivity</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">!!    integer, parameter :: IEMS = 00  ! same air/ground temp; fixed emis = 1.0</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">!!    integer, parameter :: IEMS = 01  ! same air/ground temp; varying veg typ based emis</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">!!    integer, parameter :: IEMS = 10  ! diff air/ground temp; fixed emis = 1.0</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">!!    integer, parameter :: IEMS = 11  ! diff air/ground temp; varying veg typ based emis</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">!  ---  IAER  controls aerosols scheme selections</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">!     integer, parameter :: IAER = abc --&gt; abc are three digits integer</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">!     numbers</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">!                                          to control aerosol effect</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">!     a: stratospheric-volcanic forcing;  b: lw radiation;  c: sw</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">!     radiation.</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">!      a=0: no stratospheric-volcanic aerosol effect;   =1: include the</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">!      effect.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">!      b=0: no lw tropospheric aerosols; =1: lw compute 1 bnd; =2: lw</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">!      compute multi bnd.</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">!      c=0: no sw tropospheric aerosols; =1: sw compute multi band.</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">!  ---  IOVR controls cloud overlapping method in radiation:</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">!     integer, parameter :: IOVR_SW = 0  ! sw: random overlap clouds</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">!!    integer, parameter :: IOVR_SW = 1  ! sw: max-random overlap clouds</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">!     integer, parameter :: IOVR_LW = 0  ! lw: random overlap clouds</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">!!    integer, parameter :: IOVR_LW = 1  ! lw: max-random overlap clouds</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">!  ---  ISUBC controls sub-column cloud approximation in radiation:</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">!!    integer, parameter :: ISUBC_SW = 0 ! sw: without sub-col clds approx</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">!     integer, parameter :: ISUBC_SW = 1 ! sw: sub-col clds with</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">!     prescribed seeds</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">!     integer, parameter :: ISUBC_SW = 2 ! sw: sub-col clds with random seeds</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">!!    integer, parameter :: ISUBC_LW = 0 ! lw: without sub-col clds approx</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">!     integer, parameter :: ISUBC_LW = 1 ! lw: sub-col clds with</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">!     prescribed seeds</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">!     integer, parameter :: ISUBC_LW = 2 ! lw: sub-col clds with random seeds</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">!  ---  iflip indicates model vertical index direction:</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">!     integer, parameter :: IFLIP = 0    ! virtical profile index from top to bottom</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">!!    integer, parameter :: IFLIP = 1    ! virtical profile index from bottom to top</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">!    The following parameters are from gbphys</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">!     real (kind=kind_phys), parameter :: dxmax=-16.118095651,          &amp;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">!    &amp;                                    dxmin=-9.800790154,           &amp;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">!    &amp;                                    dxinv=1.0/(dxmax-dxmin)</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">!     logical :: change</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordtype">logical</span>, <span class="keywordtype">save</span> :: first, sas_shal</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keyword">data</span>  first / .true. /</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">!  ---  for debug test use</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordtype">real (kind=kind_phys)</span> :: temlon, temlat, alon, alat</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordtype">integer</span> :: ipt</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordtype">logical</span> :: lprnt</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">!  ---  timers:</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">!     real*8 :: rtc, timer1, timer2</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">!===&gt; *** ...  begin here</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordtype">integer</span>   i,j,k,n,item,dbgu</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      idat = 0</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      idat(1) = idate(4)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      idat(2) = idate(2)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      idat(3) = idate(3)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      idat(5) = idate(1)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      rinc = 0.</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">! test repro</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">!     rinc(2) = fhour</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      rinc(2) = phour</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">!     print *,&#39; idate &#39;,idate</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">!     print *,&#39; rinc &#39;,rinc</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keyword">call </span>w3kind(w3kindreal,w3kindint)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">if</span>(w3kindreal==4) <span class="keywordflow">then</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        rinc4=rinc</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keyword">call </span>w3movdat(rinc4, idat, jdat)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keyword">call </span>w3movdat(rinc, idat, jdat)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">!     print *,&#39; jdat &#39;,jdat</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        first = .false.</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;           </div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">!     endif         ! end_if_first</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">!===&gt; *** ...  radiation initialization</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      dtsw  = fhswr                  <span class="comment">! fhswr is in sec</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      dtlw  = fhlwr                  <span class="comment">! fhlwr is in sec</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      raddt = min(dtsw, dtlw)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      raddt = min(dtsw, dtlw)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">!     if ( fhour &gt; 0.0 ) then</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span> ( phour &gt; 0.0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        solhr = mod(float(jdat(5)),24.0) <span class="comment">! hour after 00z at current fcst time</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        solhr = idate(1)                 <span class="comment">! initial time</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemodule__radiation__driver.html#a47f0e4defe607fbfc751f6c9274f459a">radupdate</a>                                                    &amp;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;     &amp;     ( idat, jdat, dtsw, deltim, lsswr, me,                       &amp;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">!  ---  outputs:</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;     &amp;       slag, sdec, cdec, solcon                                   &amp;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;     &amp;     )</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">!  --- ...  generate 2-d random seeds array for sub-grid cloud-radiation</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">if</span> ( isubc_lw==2 .or. isubc_sw==2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">!       ipseed = mod(nint(100.0*sqrt(fhour*3600)), ipsdlim) + 1 + ipsd0</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        ipseed = mod(nint(100.0*sqrt(phour*3600)), ipsdlim) + 1 + <a class="code" href="namespacephysparam.html#adadc8b256d78414cf84290d1bec23fe6">ipsd0</a></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keyword">call </span>random_setseed                                             &amp;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     &amp;     ( ipseed,                                                    &amp;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">!  ---  outputs:</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;     &amp;       stat                                                       &amp;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;     &amp;      )</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keyword">call </span>random_index                                               &amp;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;     &amp;     ( ipsdlim,                                                   &amp;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">!  ---  outputs:</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;     &amp;       numrdm, stat                                               &amp;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;     &amp;     )</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">do</span> k = 1, 2</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;          <span class="keywordflow">do</span> j = 1, lats_node_r</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            lat = global_lats_r(ipt_lats_node_r-1+j)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">!$omp parallel do private(i)</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">do</span> i = 1, lonr</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;              ixseed(i,j,k) = numrdm(i+(lat-1)*lonr+(k-1)*latr)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">!===&gt; *** ...  starting latitude loop</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">!              ----------------------</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">do</span> lan=1,lats_node_r</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;         lat = global_lats_r(ipt_lats_node_r-1+lan)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;         lons_lat = lonsperlar(lat)</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">!$omp parallel do schedule(dynamic,1)</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">!$omp+private(lon,i,j,k,item,njeff,iblk,n)</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">!$omp+private(vvel,gt,gr,gr1,work1,work2,flgmin_v)</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">!$omp+private(cldcov_v,hprime_v,fluxr_v,f_ice,f_rain,r_rime)</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">!$omp+private(deltaq,cnvw,cnvc)</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">!$omp+private(coszen_v,coszdg_v,sinlat_v,coslat_v)</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">!$omp+private(prslk,prsl,prsi,topfsw,sfcfsw,topflw,sfcflw)</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">!$omp+private(icsdsw,icsdlw)</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">!$omp+private(hlwc_v,swhc_v)</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">!$omp+private(lprnt,ipt)</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">!$omp+private(dswcmp,uswcmp)</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">!!$omp+private(temlon,temlat,lprnt,ipt)</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">!!$omp+private(lprnt,ipt,dbgu)</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">!!!$omp+private(temlon,temlat,lprnt,ipt)</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">do</span> lon=1,lons_lat,ngptc</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          njeff = min(ngptc,lons_lat-lon+1)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          iblk  = (lon-1)/ngptc + 1</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          lprnt = .false.</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          ipt   = 1</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">!  --- ...  for debug test</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">!         alon = 0.0</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">!         alat = 2.0</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">!         alon = 236.25</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">!         alat = 56.189</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">!         alon = 22.5</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">!         alat = -12.381</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">!         ipt = 0</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">!         do i = 1, njeff</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">!           item = lon + i - 1</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">!           temlon = xlon(item,lan) * 57.29578</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">!           if (temlon &lt; 0.0) temlon = temlon + 360.0</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">!           temlat = xlat(item,lan) * 57.29578</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">!           lprnt = abs(temlon-alon) &lt; 0.5 .and. abs(temlat-alat) &lt; 0.5</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">!    &amp;          .and. kdt &gt; 0</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">!           if ( lprnt ) then</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">!             ipt = i</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">!             print *,&#39; ipt=&#39;,ipt,&#39; lon=&#39;,lon,&#39; lan=&#39;,lan</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">!             exit</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">!           endif</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">!         enddo</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">!hmhj     do i = 1, njeff</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">!hmhj       prsi(i,1) = grid_fld%ps(lon+i-1,lan)</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">!hmhj     enddo</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          <span class="keywordflow">do</span> k = 1, levr</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;              item        = lon+i-1</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;              gt(i,k)     = grid_fld%t(item,lan,k)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;              gr(i,k)   = max(qmin,grid_fld%tracers(1)%flds(item,lan,k))</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;              prsl(i,k)   = grid_fld%p(item,lan,k)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;              vvel(i,k)   = grid_fld%dpdt(item,lan,k)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">!hmhj         prsi(i,k+1) = prsi(i,k) - grid_fld%dp(item,lan,k)</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">!hmhj prsi should be computed from model top for accuray</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            prsi(i,levs+1) = 0.0</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          <span class="keywordflow">do</span> k = levs, 1, -1</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              item        = lon+i-1</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;              prsi(i,k) = prsi(i,k+1) + grid_fld%dp(item,lan,k)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">!       Remaining tracers</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         <span class="keywordflow">do</span> n = 2, ntrac</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            item = n - 1</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">do</span> k = 1, levr</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;              <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                gr1(i,k,item) = grid_fld%tracers(n)%flds(lon+i-1,lan,k)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          <span class="keywordflow">if</span>(num_p3d == 4) <span class="keywordflow">then</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordflow">if</span>(kdt == 1.or.(kdt == ndfi+1.and.fhdfi == 0.)) <span class="keywordflow">then</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;              <span class="keywordflow">do</span> k = 1, levs</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                  item = lon + i - 1</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                  phy_f3d(i,k,1,iblk,lan) = gt(i,k)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                  phy_f3d(i,k,2,iblk,lan) = gr(i,k)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                  phy_f3d(i,k,3,iblk,lan) = gt(i,k)</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                  phy_f3d(i,k,4,iblk,lan) = gr(i,k)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;              <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                item = lon + i - 1</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                phy_f2d(item,lan,1) = prsi(i,1)</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                phy_f2d(item,lan,2) = prsi(i,1)</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">!.....</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;          <span class="keywordflow">if</span> (levr &lt; levs) <span class="keywordflow">then</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;              prsi(i,levr+1)  = prsi(i,levp1)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;              prsl(i,levr)    = (prsi(i,levp1)+prsi(i,levr)) * 0.5</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          <span class="keywordflow">if</span> (ntoz &lt;= 0 .or. <a class="code" href="namespacephysparam.html#a2b30f07ca3fb04fbfff8c01eb8082e8d">iaerflg</a> == 2) <span class="keywordflow">then</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">do</span> k = 1, levs</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;              <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                prslk(i,k) = (prsl(i,k)*pt00001)**rk</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          <span class="keywordflow">if</span> (shoc_cld) <span class="keywordflow">then</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">do</span> k = 1, levs</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;              <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                cldcov_v(i,k) = phy_f3d(i,k,ntot3d-2,iblk,lan)</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">!             write(1000+me,*)&#39;sgs_clds=&#39;,maxval(cldcov_v(1:njeff,:)),</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">!    &amp;       &#39; lan=&#39;,lan</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;          <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            hprime_v(i) = hprime(1,lon+i-1,lan)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          <span class="keywordflow">do</span> k=1,nfxr</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;              fluxr_v(i,k) = fluxr(k,lon+i-1,lan)</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          <span class="keywordflow">do</span> j = 1, njeff</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            sinlat_v(j) = sinlat_r(lat)</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            coslat_v(j) = coslat_r(lat)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="keywordflow">if</span> (num_p3d == 3) <span class="keywordflow">then</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordflow">do</span> k = 1, levr</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;              <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                f_ice(i,k) = phy_f3d(i,k,1,iblk,lan)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                f_rain(i,k) = phy_f3d(i,k,2,iblk,lan)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                r_rime(i,k) = phy_f3d(i,k,3,iblk,lan)</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            work1 = (log(coslat_r(lat)/(lons_lat*latr)) - <a class="code" href="namespacephyscons.html#a0d975826ce89583acdad7f32e028d979">dxmin</a>) * <a class="code" href="namespacephyscons.html#ab94b4700f51149d28ed380c687f36c49">dxinv</a></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            work1 = max(0.0, min(1.0,work1))</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            work2 = flgmin(1)*work1 + flgmin(2)*(1.0-work1)</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;              flgmin_v(i) = work2</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;              flgmin_v(i) = 0.0</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          <span class="keywordflow">if</span>(num_p3d == 4 .and. npdf3d == 3) <span class="keywordflow">then</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">do</span> k = 1, levr</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;              <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                deltaq(i,k) = phy_f3d(i,k,5,iblk,lan)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                cnvw(i,k)   = phy_f3d(i,k,6,iblk,lan)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                cnvc(i,k)   = phy_f3d(i,k,7,iblk,lan)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keywordflow">do</span> k = 1, levr</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;              <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                deltaq(i,k) = 0.0</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                cnvw(i,k)   = 0.0</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                cnvc(i,k)   = 0.0</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">!  --- ...  assign random seeds for sw and lw radiations</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;          <span class="keywordflow">if</span> ( isubc_lw==2 .or. isubc_sw==2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;              icsdsw(i) = ixseed(lon+i-1,lan,1)</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;              icsdlw(i) = ixseed(lon+i-1,lan,2)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">!  *** ...  calling radiation driver</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacemodule__radiation__driver.html#a8285cf6a4d2e1ed25b0afff8e269ec63">grrad</a></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">!  ---  inputs:</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;     &amp;     ( prsi,prsl,prslk,gt,gr,gr1,vvel,slmsk(lon,lan),             &amp;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;     &amp;       xlon(lon,lan),xlat(lon,lan),tsea(lon,lan),                 &amp;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;     &amp;       snwdph(lon,lan),sncovr(lon,lan),snoalb(lon,lan),           &amp;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;     &amp;       zorl(lon,lan),hprime_v,                                    &amp;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;     &amp;       alvsf(lon,lan),alnsf(lon,lan),alvwf(lon,lan),              &amp;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     &amp;       alnwf(lon,lan),facsf(lon,lan),facwf(lon,lan),              &amp;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;     &amp;       fice(lon,lan),tisfc(lon,lan),                              &amp;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;     &amp;       sinlat_v,coslat_v,solhr,jdat,solcon,                       &amp;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;     &amp;       cv(lon,lan),cvt(lon,lan),cvb(lon,lan),                     &amp;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;     &amp;       f_ice,f_rain,r_rime,flgmin_v,                              &amp;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;     &amp;       icsdsw,icsdlw,ntcw-1,ncld,ntoz-1,ntrac-1,nfxr,             &amp;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">!    &amp;       dtlw,dtsw, lsswr,lslwr,lssav,                              &amp;</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;     &amp;       dtlw,dtsw, lsswr,lslwr,lssav,shoc_cld,                     &amp;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;     &amp;       ngptc,njeff,levr,me, lprnt, ipt, kdt, deltaq,sup,cnvw,cnvc,&amp;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">!  ---  outputs:</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;     &amp;       swh(1:ngptc,1:levr,iblk,lan),topfsw,sfcfsw,dswcmp,uswcmp,  &amp;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;     &amp;       sfalb(lon,lan),coszen_v,coszdg_v,                          &amp;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;     &amp;       hlw(1:ngptc,1:levr,iblk,lan),topflw,sfcflw,tsflw(lon,lan), &amp;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;     &amp;       sfcemis(lon,lan),cldcov_v,                                 &amp;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">!  ---  input/output:</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;     &amp;       fluxr_v,                                                   &amp; </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">!    &amp;       fluxr_v, dbgu                                              &amp; </span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">!! ---  optional outputs:</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;     &amp;       htrlw0=hlwc_v,htrsw0=swhc_v                                &amp;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">!!   &amp;,      HTRSWB=htrswb(1,1,1,iblk,lan),                             &amp;</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">!!   &amp;,      HTRLWB=htrlwb(1,1,1,iblk,lan)                              &amp;</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;     &amp;     )</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="keywordflow">do</span> j = 1, njeff</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            coszen(lon+j-1,lan) = coszen_v(j)</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            coszdg(lon+j-1,lan) = coszdg_v(j)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="keywordflow">do</span> k=1,nfxr</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;              fluxr(k,lon+i-1,lan) = fluxr_v(i,k)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">!  --- ...  radiation fluxes for other physics process or diagnostics</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          <span class="keywordflow">if</span> (lsswr) <span class="keywordflow">then</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;              j = lon + i - 1</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;              sfcdsw(j,lan) = sfcfsw(i)%dnfxc</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;              sfcnsw(j,lan) = sfcfsw(i)%dnfxc - sfcfsw(i)%upfxc</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">!             sfcnirbmd(j,lan)=dswcmp(i,1)</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">!             sfcnirdfd(j,lan)=dswcmp(i,2)</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">!             sfcvisbmd(j,lan)=dswcmp(i,3)</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">!             sfcvisdfd(j,lan)=dswcmp(i,4)</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">!             sfcnirbmu(j,lan)=uswcmp(i,1)</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">!             sfcnirdfu(j,lan)=uswcmp(i,2)</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">!             sfcvisbmu(j,lan)=uswcmp(i,3)</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">!             sfcvisdfu(j,lan)=uswcmp(i,4)</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">if</span> (cplflx) <span class="keywordflow">then</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                j = lon + i - 1</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                aoi_fld%nirbmdi(j,lan) = dswcmp(i,1)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                aoi_fld%nirdfdi(j,lan) = dswcmp(i,2)</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                aoi_fld%visbmdi(j,lan) = dswcmp(i,3)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                aoi_fld%visdfdi(j,lan) = dswcmp(i,4)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                aoi_fld%nirbmui(j,lan) = uswcmp(i,1)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                aoi_fld%nirdfui(j,lan) = uswcmp(i,2)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                aoi_fld%visbmui(j,lan) = uswcmp(i,3)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                aoi_fld%visdfui(j,lan) = uswcmp(i,4)</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <span class="keywordflow">if</span> (lslwr) <span class="keywordflow">then</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">do</span> i = 1, njeff</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;              j = lon + i - 1</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;              sfcdlw(j,lan) = sfcflw(i)%dnfxc</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">do</span> k=1,levr</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;              <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                hlwc(i,k,iblk,lan) = hlwc_v(i,k)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          <span class="keywordflow">do</span> k=1,levr</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;              swhc(i,k,iblk,lan) = swhc_v(i,k)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;          <span class="keywordflow">if</span> (levr &lt; levs) <span class="keywordflow">then</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keywordflow">do</span> k=levr+1,levs</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;              <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                hlw(i,k,iblk,lan)  = hlw(i,levr,iblk,lan)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                hlwc(i,k,iblk,lan) = hlwc(i,levr,iblk,lan)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                swh(i,k,iblk,lan)  = swh(i,levr,iblk,lan)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                swhc(i,k,iblk,lan) = swhc(i,levr,iblk,lan)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">!     if (lprnt) then</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">!       write(0,*)&#39; hlw=&#39;,hlw(ipt,1:10,iblk,lan),&#39; lan=&#39;,lan,&#39; ipt=&#39;,ipt,</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">!    &amp;            &#39; njeff=&#39;,njeff</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">!       write(0,*)&#39; swh=&#39;,swh(ipt,1:10,iblk,lan),&#39; lan=&#39;,lan</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">!     endif</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">! grrad routine computes cldcov_v (instant 3D cloud cover)    -- Sarah Lu</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">! if ldiag3d is T, update cldcov (accumulative 3D cloud cover)</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">! if lgocart is T, update fcld (instant 3D cloud cover)</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          <span class="keywordflow">if</span> (lssav) <span class="keywordflow">then</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keywordflow">if</span> (ldiag3d) <span class="keywordflow">then</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;              <span class="keywordflow">do</span> k=1,levr</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                  item = lon+i-1</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                  cldcov(k,item,lan) = cldcov(k,item,lan)                 &amp;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;     &amp;                               + cldcov_v(i,k) * raddt</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          <span class="keywordflow">if</span> (lgocart) <span class="keywordflow">then</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordflow">do</span> k=1,levr</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;              <span class="keywordflow">do</span> i=1,njeff</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                g3d_fld%fcld(lon+i-1,lan,k) = cldcov_v(i,k) </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keywordflow">              enddo</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">!$$$          write(2900+lat,*) &#39; ilon = &#39;,lon</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">!$$$          write(2900+lat,&#39;(&quot;swh&quot;,T16,&quot;hlw&quot;)&#39;)</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">!$$$      do k=1,levs</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">!$$$         write(2900+lat,</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">!$$$     .         &#39;(e10.3,T16,e10.3,T31,e10.3)&#39;)</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">!$$$     . swh(1,k,iblk,lan),hlw(1,k,iblk,lan)</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">!$$$       enddo</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keywordflow">        enddo</span>                       <span class="comment">! end of lon if loop</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keywordflow">      enddo</span>                         <span class="comment">! end of lan if loop</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keyword">      end subroutine </span>gloopr</div><div class="ttc" id="namespacephysparam_html_a2b30f07ca3fb04fbfff8c01eb8082e8d"><div class="ttname"><a href="namespacephysparam.html#a2b30f07ca3fb04fbfff8c01eb8082e8d">physparam::iaerflg</a></div><div class="ttdeci">integer, save iaerflg</div><div class="ttdoc">aerosol effect control flag </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00155">physparam.f:155</a></div></div>
<div class="ttc" id="namespacemodule__radsw__parameters_html_structmodule__radsw__parameters_1_1topfsw__type"><div class="ttname"><a href="namespacemodule__radsw__parameters.html#structmodule__radsw__parameters_1_1topfsw__type">module_radsw_parameters::topfsw_type</a></div><div class="ttdoc">define type construct for radiation fluxes at toa </div><div class="ttdef"><b>Definition:</b> <a href="radsw__param_8f_source.html#l00070">radsw_param.f:70</a></div></div>
<div class="ttc" id="namespacephyscons_html"><div class="ttname"><a href="namespacephyscons.html">physcons</a></div><div class="ttdoc">This module contains some the most frequently used math and physics constants for gcm models...</div><div class="ttdef"><b>Definition:</b> <a href="physcons_8f_source.html#l00029">physcons.f:29</a></div></div>
<div class="ttc" id="namespacephysparam_html_adadc8b256d78414cf84290d1bec23fe6"><div class="ttname"><a href="namespacephysparam.html#adadc8b256d78414cf84290d1bec23fe6">physparam::ipsd0</a></div><div class="ttdeci">integer, save ipsd0</div><div class="ttdoc">initial permutation seed for mcica radiation </div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00230">physparam.f:230</a></div></div>
<div class="ttc" id="namespacemodule__radsw__parameters_html_structmodule__radsw__parameters_1_1sfcfsw__type"><div class="ttname"><a href="namespacemodule__radsw__parameters.html#structmodule__radsw__parameters_1_1sfcfsw__type">module_radsw_parameters::sfcfsw_type</a></div><div class="ttdoc">define type construct for radiation fluxes at surface </div><div class="ttdef"><b>Definition:</b> <a href="radsw__param_8f_source.html#l00082">radsw_param.f:82</a></div></div>
<div class="ttc" id="namespacemodule__radiation__driver_html_a47f0e4defe607fbfc751f6c9274f459a"><div class="ttname"><a href="namespacemodule__radiation__driver.html#a47f0e4defe607fbfc751f6c9274f459a">module_radiation_driver::radupdate</a></div><div class="ttdeci">subroutine, public radupdate                                                                                        </div><div class="ttdef"><b>Definition:</b> <a href="grrad_8f_source.html#l00467">grrad.f:467</a></div></div>
<div class="ttc" id="namespacemodule__radlw__parameters_html_a39a115a97296886b2e6e37b220e942c7"><div class="ttname"><a href="namespacemodule__radlw__parameters.html#a39a115a97296886b2e6e37b220e942c7">module_radlw_parameters::nbdlw</a></div><div class="ttdeci">integer, parameter nbdlw</div><div class="ttdef"><b>Definition:</b> <a href="radlw__param_8f_source.html#l00122">radlw_param.f:122</a></div></div>
<div class="ttc" id="namespacemodule__radsw__parameters_html_ab1e121fde29dde00871e4a7d43be1ddb"><div class="ttname"><a href="namespacemodule__radsw__parameters.html#ab1e121fde29dde00871e4a7d43be1ddb">module_radsw_parameters::nbdsw</a></div><div class="ttdeci">integer, parameter nbdsw</div><div class="ttdef"><b>Definition:</b> <a href="radsw__param_8f_source.html#l00144">radsw_param.f:144</a></div></div>
<div class="ttc" id="namespacemodule__radiation__driver_html_a8285cf6a4d2e1ed25b0afff8e269ec63"><div class="ttname"><a href="namespacemodule__radiation__driver.html#a8285cf6a4d2e1ed25b0afff8e269ec63">module_radiation_driver::grrad</a></div><div class="ttdeci">subroutine, public grrad                                                                                                </div><div class="ttdoc">This subroutine is the driver of radiation calculation subroutines. It sets up profile variables for ...</div><div class="ttdef"><b>Definition:</b> <a href="grrad_8f_source.html#l00700">grrad.f:700</a></div></div>
<div class="ttc" id="namespacephysparam_html"><div class="ttname"><a href="namespacephysparam.html">physparam</a></div><div class="ttdoc">This module defines commonly used control variables/parameters in physics related programs...</div><div class="ttdef"><b>Definition:</b> <a href="physparam_8f_source.html#l00027">physparam.f:27</a></div></div>
<div class="ttc" id="namespacemodule__radsw__parameters_html"><div class="ttname"><a href="namespacemodule__radsw__parameters.html">module_radsw_parameters</a></div><div class="ttdoc">This module contains SW band parameters set up. </div><div class="ttdef"><b>Definition:</b> <a href="radsw__param_8f_source.html#l00058">radsw_param.f:58</a></div></div>
<div class="ttc" id="namespacephyscons_html_a45809304b133b2581328b19b36dd47bc"><div class="ttname"><a href="namespacephyscons.html#a45809304b133b2581328b19b36dd47bc">physcons::con_rerth</a></div><div class="ttdeci">real(kind=kind_phys), parameter con_rerth</div><div class="ttdef"><b>Definition:</b> <a href="physcons_8f_source.html#l00050">physcons.f:50</a></div></div>
<div class="ttc" id="namespacephyscons_html_a72b27573c69ec418b67763d35b3688a1"><div class="ttname"><a href="namespacephyscons.html#a72b27573c69ec418b67763d35b3688a1">physcons::con_rocp</a></div><div class="ttdeci">real(kind=kind_phys), parameter con_rocp</div><div class="ttdef"><b>Definition:</b> <a href="physcons_8f_source.html#l00104">physcons.f:104</a></div></div>
<div class="ttc" id="namespacemodule__radlw__parameters_html_structmodule__radlw__parameters_1_1sfcflw__type"><div class="ttname"><a href="namespacemodule__radlw__parameters.html#structmodule__radlw__parameters_1_1sfcflw__type">module_radlw_parameters::sfcflw_type</a></div><div class="ttdoc">define type construct for radiation fluxes at surface </div><div class="ttdef"><b>Definition:</b> <a href="radlw__param_8f_source.html#l00080">radlw_param.f:80</a></div></div>
<div class="ttc" id="namespacemodule__radlw__parameters_html"><div class="ttname"><a href="namespacemodule__radlw__parameters.html">module_radlw_parameters</a></div><div class="ttdoc">This module contains LW band parameters set up. </div><div class="ttdef"><b>Definition:</b> <a href="radlw__param_8f_source.html#l00058">radlw_param.f:58</a></div></div>
<div class="ttc" id="namespacephyscons_html_ab94b4700f51149d28ed380c687f36c49"><div class="ttname"><a href="namespacephyscons.html#ab94b4700f51149d28ed380c687f36c49">physcons::dxinv</a></div><div class="ttdeci">real(kind=kind_phys) dxinv</div><div class="ttdef"><b>Definition:</b> <a href="physcons_8f_source.html#l00159">physcons.f:159</a></div></div>
<div class="ttc" id="gloopr_8f_html_aa4598a23017d824c298984f4b1f14555"><div class="ttname"><a href="gloopr_8f.html#aa4598a23017d824c298984f4b1f14555">gloopr</a></div><div class="ttdeci">subroutine gloopr(grid_fld, g3d_fld, aoi_fld,                                                                           lats_nodes_r, global_lats_r, lonsperlar, phour,                                     deltim, xlon, xlat, coszdg, COSZEN, slmsk, snwdph,                                         SNCOVR, SNOALB, ZORL, TSEA, HPRIME, SFALB,                                                       ALVSF, ALNSF,ALVWF,ALNWF, FACSF,FACWF, CV, CVT,                                     CVB ,SWH, swhc, HLW, hlwc, SFCNSW, SFCDLW,                                                     FICE,TISFC, SFCDSW, sfcemis,                                                                       TSFLW, FLUXR, phy_f3d, phy_f2d,                                                                       slag, sdec, cdec, NBLCK, KDT                                        </div><div class="ttdoc">NCEP/GFS shortwave (SW) radiation module. radiation driver, gloopr.f, calls grrad.f, which prepares atmospheric profiles, invokes main radiation calculations, and computes radiative fluxes and heating rates for some arbitrary number of vertical columns. </div><div class="ttdef"><b>Definition:</b> <a href="gloopr_8f_source.html#l00020">gloopr.f:20</a></div></div>
<div class="ttc" id="namespacemersenne__twister_html"><div class="ttname"><a href="namespacemersenne__twister.html">mersenne_twister</a></div><div class="ttdef"><b>Definition:</b> <a href="mersenne__twister_8f_source.html#l00160">mersenne_twister.f:160</a></div></div>
<div class="ttc" id="namespacemodule__radlw__parameters_html_structmodule__radlw__parameters_1_1topflw__type"><div class="ttname"><a href="namespacemodule__radlw__parameters.html#structmodule__radlw__parameters_1_1topflw__type">module_radlw_parameters::topflw_type</a></div><div class="ttdoc">define type construct for radiation fluxes at toa </div><div class="ttdef"><b>Definition:</b> <a href="radlw__param_8f_source.html#l00070">radlw_param.f:70</a></div></div>
<div class="ttc" id="namespacephyscons_html_ad200a2d8149c61dbdd05124ce977a928"><div class="ttname"><a href="namespacephyscons.html#ad200a2d8149c61dbdd05124ce977a928">physcons::con_fvirt</a></div><div class="ttdeci">real(kind=kind_phys), parameter con_fvirt</div><div class="ttdef"><b>Definition:</b> <a href="physcons_8f_source.html#l00107">physcons.f:107</a></div></div>
<div class="ttc" id="namespacemodule__radiation__driver_html_af039e0c23dc6ab8d2f8b1c1c796ac0da"><div class="ttname"><a href="namespacemodule__radiation__driver.html#af039e0c23dc6ab8d2f8b1c1c796ac0da">module_radiation_driver::radinit</a></div><div class="ttdeci">subroutine, public radinit                                                                                            </div><div class="ttdef"><b>Definition:</b> <a href="grrad_8f_source.html#l00256">grrad.f:256</a></div></div>
<div class="ttc" id="namespacemodule__radiation__driver_html"><div class="ttname"><a href="namespacemodule__radiation__driver.html">module_radiation_driver</a></div><div class="ttdoc">This file is the radiation driver module. it prepares atmospheric profiles and invokes main radiation...</div><div class="ttdef"><b>Definition:</b> <a href="grrad_8f_source.html#l00184">grrad.f:184</a></div></div>
<div class="ttc" id="namespacephyscons_html_a0d975826ce89583acdad7f32e028d979"><div class="ttname"><a href="namespacephyscons.html#a0d975826ce89583acdad7f32e028d979">physcons::dxmin</a></div><div class="ttdeci">real(kind=kind_phys) dxmin</div><div class="ttdef"><b>Definition:</b> <a href="physcons_8f_source.html#l00159">physcons.f:159</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d4ccef7ee686e65ae32d416762724474.html">working_src</a></li><li class="navelem"><a class="el" href="gloopr_8f.html">gloopr.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
